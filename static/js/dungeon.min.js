function init(){fillMap(map),addPlayer()}function getMask(e,t){var a=0,n=2*(map.getTile(e,t-1)||0),l=8*(map.getTile(e-1,t)||0),d=16*(map.getTile(e+1,t)||0),o=64*(map.getTile(e,t+1)||0);a+=n+l+d+o,n>0&&l>0&&(a+=map.getTile(e-1,t-1)||0),n>0&&d>0&&(a+=4*(map.getTile(e+1,t-1)||0)),o>0&&l>0&&(a+=32*(map.getTile(e-1,t+1)||0)),o>0&&d>0&&(a+=128*(map.getTile(e+1,t+1)||0));var i={2:1,8:2,10:3,11:4,16:5,18:6,22:7,24:8,26:9,27:10,30:11,31:12,64:13,66:14,72:15,74:16,75:17,80:18,82:19,86:20,88:21,90:22,91:23,94:24,95:25,104:26,106:27,107:28,120:29,122:30,123:31,126:32,127:33,208:34,210:35,214:36,216:37,218:38,219:39,222:40,223:41,248:42,250:43,251:44,254:45,255:46,0:47};return i[a+""]}function fillMap(e){dungeon=document.getElementById("dungeon"),dungeon.style.width="512px",dungeon.style.height="512px";for(var t=document.createDocumentFragment(),a=0;T_COUNT>a;a++)for(var n=0;T_COUNT>n;n++){var l=document.createElement("div");l.id=n+"_"+a,l.className="dungeonTile",l.style.width="64px",l.style.height="64px",e.getTile(n,a)>0&&(l.style.backgroundImage="url('static/img/tiles/"+getMask(n,a)+".png')"),l.addEventListener("click",moveHere),l.dataset.x=n,l.dataset.y=a,t.appendChild(l)}dungeon.appendChild(t)}function addPlayer(){dungeon=document.getElementById("dungeon");var e=document.createElement("div");e.id="player",e.className="dungeonObject",e.style.width="64px",e.style.height="64px",e.style.backgroundImage="url('static/img/velbird.png')",e.style.backgroundSize="64px 64px ",dungeon.appendChild(e)}function movePlayer(e,t){var a=document.getElementById("player");1==map.getTile(player.x+e,player.y+t)&&(player.x+=e,player.y+=t,a.style.left=player.x*T_WIDTH+"px",a.style.top=player.y*T_WIDTH-PLAYER_OFFSET+"px")}function checkKey(e){e=e||window.event,"38"==e.keyCode||"87"==e.keyCode?movePlayer(0,-1):"40"==e.keyCode||"83"==e.keyCode?movePlayer(0,1):"37"==e.keyCode||"65"==e.keyCode?movePlayer(-1,0):"39"!=e.keyCode&&"68"!=e.keyCode||movePlayer(1,0)}function moveHere(){Math.abs(this.dataset.x-player.x)>Math.abs(this.dataset.y-player.y)?this.dataset.x-player.x>0?movePlayer(1,0):movePlayer(-1,0):this.dataset.y-player.y>0?movePlayer(0,1):movePlayer(0,-1)}window.onload=init;const T_WIDTH=64,T_COUNT=8,TILE_LOC="static/img/tiles/",PLAYER_OFFSET=20;var map={cols:T_COUNT,rows:T_COUNT,tsize:T_WIDTH,tiles:[1,1,0,0,0,1,1,1,1,1,1,1,1,0,0,1,0,1,1,0,1,0,1,1,1,0,1,0,1,1,1,0,0,0,1,1,0,1,1,1,0,1,1,1,1,1,1,0,1,1,1,0,0,1,1,0,0,1,0,0,0,0,0,0],getTile:function(e,t){return e>map.cols-1||t>map.rows-1||0>t||0>e?0:this.tiles[t*map.cols+e]}},player={x:0,y:0};document.onkeydown=checkKey,window.addEventListener("keydown",function(e){[32,37,38,39,40].indexOf(e.keyCode)>-1&&e.preventDefault()},!1);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImR1bmdlb24uanMiXSwibmFtZXMiOlsiaW5pdCIsImZpbGxNYXAiLCJtYXAiLCJhZGRQbGF5ZXIiLCJnZXRNYXNrIiwieCIsInkiLCJ0b3RhbCIsIm5vcnRoIiwiZ2V0VGlsZSIsIndlc3QiLCJlYXN0Iiwic291dGgiLCJjb252ZXJ0ZXIiLCIyIiwiOCIsIjEwIiwiMTEiLCIxNiIsIjE4IiwiMjIiLCIyNCIsIjI2IiwiMjciLCIzMCIsIjMxIiwiNjQiLCI2NiIsIjcyIiwiNzQiLCI3NSIsIjgwIiwiODIiLCI4NiIsIjg4IiwiOTAiLCI5MSIsIjk0IiwiOTUiLCIxMDQiLCIxMDYiLCIxMDciLCIxMjAiLCIxMjIiLCIxMjMiLCIxMjYiLCIxMjciLCIyMDgiLCIyMTAiLCIyMTQiLCIyMTYiLCIyMTgiLCIyMTkiLCIyMjIiLCIyMjMiLCIyNDgiLCIyNTAiLCIyNTEiLCIyNTQiLCIyNTUiLCIwIiwiZHVuZ2VvbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsIndpZHRoIiwiaGVpZ2h0IiwidG9BZGQiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwiaSIsIlRfQ09VTlQiLCJqIiwibmV3RGl2IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY2xhc3NOYW1lIiwiVF9XSURUSCIsImJhY2tncm91bmRJbWFnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJtb3ZlSGVyZSIsImRhdGFzZXQiLCJhcHBlbmRDaGlsZCIsInBsYXllckRpdiIsImJhY2tncm91bmRTaXplIiwibW92ZVBsYXllciIsInBsYXllciIsImxlZnQiLCJ0b3AiLCJQTEFZRVJfT0ZGU0VUIiwiY2hlY2tLZXkiLCJlIiwid2luZG93IiwiZXZlbnQiLCJrZXlDb2RlIiwiTWF0aCIsImFicyIsInRoaXMiLCJvbmxvYWQiLCJUSUxFX0xPQyIsImNvbHMiLCJyb3dzIiwidHNpemUiLCJ0aWxlcyIsImNvbCIsInJvdyIsIm9ua2V5ZG93biIsImluZGV4T2YiLCJwcmV2ZW50RGVmYXVsdCJdLCJtYXBw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LEVBQ1Y0QixTQUFXLG9CQUNYVixjQUFnQixFQUV0QixJQUFJdEYsTUFDRmlHLEtBQU03QixRQUNOOEIsS0FBTTlCLFFBQ04rQixNQUFPekIsUUFDUDBCLE9BQ0UsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUNyQixFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQ3JCLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDckIsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUNyQixFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQ3JCLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDckIsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUNyQixFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEdBRXZCN0YsUUFBUyxTQUFTOEYsRUFBS0MsR0FDckIsTUFBSUQsR0FBTXJHLElBQUlpRyxLQUFPLEdBQUtLLEVBQU10RyxJQUFJa0csS0FBTyxHQUFXLEVBQU5JLEdBQWlCLEVBQU5ELEVBQ2xELEVBRUZQLEtBQUtNLE1BQU1FLEVBQU10RyxJQUFJaUcsS0FBT0ksS0FJbkNsQixRQUNGaEYsRUFBRyxFQUNIQyxFQUFHLEVBMEVMd0QsVUFBUzJDLFVBQVloQixTQUVyQkUsT0FBT2IsaUJBQWlCLFVBQVcsU0FBU1ksSUFFcEMsR0FBSSxHQUFJLEdBQUksR0FBSSxJQUFJZ0IsUUFBUWhCLEVBQUVHLFNBQVcsSUFDekNILEVBQUVpQixtQkFFUCIsImZpbGUiOiJkdW5nZW9uLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIndpbmRvdy5vbmxvYWQgPSBpbml0O1xuXG5mdW5jdGlvbiBpbml0KCkge1xuICBmaWxsTWFwKG1hcCk7XG4gIGFkZFBsYXllcigpO1xufVxuXG5jb25zdCBUX1dJRFRIID0gNjQ7XG5jb25zdCBUX0NPVU5UID0gODtcbmNvbnN0IFRJTEVfTE9DID0gXCJzdGF0aWMvaW1nL3RpbGVzL1wiXG5jb25zdCBQTEFZRVJfT0ZGU0VUID0gMjA7XG5cbnZhciBtYXAgPSB7XG4gIGNvbHM6IFRfQ09VTlQsXG4gIHJvd3M6IFRfQ09VTlQsXG4gIHRzaXplOiBUX1dJRFRILFxuICB0aWxlczogW1xuICAgIDEsIDEsIDAsIDAsIDAsIDEsIDEsIDEsXG4gICAgMSwgMSwgMSwgMSwgMSwgMCwgMCwgMSxcbiAgICAwLCAxLCAxLCAwLCAxLCAwLCAxLCAxLFxuICAgIDEsIDAsIDEsIDAsIDEsIDEsIDEsIDAsXG4gICAgMCwgMCwgMSwgMSwgMCwgMSwgMSwgMSxcbiAgICAwLCAxLCAxLCAxLCAxLCAxLCAxLCAwLFxuICAgIDEsIDEsIDEsIDAsIDAsIDEsIDEsIDAsXG4gICAgMCwgMSwgMCwgMCwgMCwgMCwgMCwgMFxuICBdLFxuICBnZXRUaWxlOiBmdW5jdGlvbihjb2wsIHJvdykge1xuICAgIGlmIChjb2wgPiBtYXAuY29scyAtIDEgfHwgcm93ID4gbWFwLnJvd3MgLSAxIHx8IHJvdyA8IDAgfHwgY29sIDwgMCkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnRpbGVzW3JvdyAqIG1hcC5jb2xzICsgY29sXTtcbiAgfVxufTtcblxudmFyIHBsYXllciA9IHtcbiAgeDogMCxcbiAgeTogMFxufTtcblxuXG5mdW5jdGlvbiBnZXRNYXNrKHgsIHkpIHtcbiAgdmFyIHRvdGFsID0gMDtcbiAgdmFyIG5vcnRoID0gIDIgKiAobWFwLmdldFRpbGUoeCwgeSAtIDEpIHx8IDApO1xuICB2YXIgd2VzdCA9IDggKiAobWFwLmdldFRpbGUoeCAtIDEsIHkpIHx8IDApO1xuICB2YXIgZWFzdCA9IDE2ICogKG1hcC5nZXRUaWxlKHggKyAxLCB5KSB8fCAwKTtcbiAgdmFyIHNvdXRoID0gNjQgKiAobWFwLmdldFRpbGUoeCwgeSArIDEpIHx8IDApO1xuICB0b3RhbCArPSBub3J0aCArIHdlc3QgKyBlYXN0ICsgc291dGg7XG4gIGlmIChub3J0aCA+IDAgJiYgd2VzdCA+IDApIHtcbiAgICB0b3RhbCArPSAobWFwLmdldFRpbGUoeCAtIDEsIHkgLSAxKSB8fCAwKTtcbiAgfVxuICBpZiAobm9ydGggPiAwICYmIGVhc3QgPiAwKSB7XG4gICAgdG90YWwgKz0gNCAqIChtYXAuZ2V0VGlsZSh4ICsgMSwgeSAtIDEpIHx8IDApO1xuICB9XG4gIGlmIChzb3V0aCA+IDAgJiYgd2VzdCA+IDApIHtcbiAgICB0b3RhbCArPSAzMiAqIChtYXAuZ2V0VGlsZSh4IC0gMSwgeSArIDEpIHx8IDApO1xuICB9XG4gIGlmIChzb3V0aCA+IDAgJiYgZWFzdCA+IDApIHtcbiAgICB0b3RhbCArPSAxMjggKiAobWFwLmdldFRpbGUoeCArIDEsIHkgKyAxKSB8fCAwKTtcbiAgfVxuICB2YXIgY29udmVydGVyID0geyBcIjJcIiA6IDEsIFwiOFwiIDogMiwgXCIxMFwiIDogMywgXCIxMVwiIDogNCwgXCIxNlwiIDogNSwgXCIxOFwiIDogNiwgXCIyMlwiIDogNywgXCIyNFwiIDogOCwgXCIyNlwiIDogOSwgXCIyN1wiIDogMTAsIFwiMzBcIiA6IDExLCBcIjMxXCIgOiAxMiwgXCI2NFwiIDogMTMsIFwiNjZcIiA6IDE0LCBcIjcyXCIgOiAxNSwgXCI3NFwiIDogMTYsIFwiNzVcIiA6IDE3LCBcIjgwXCIgOiAxOCwgXCI4MlwiIDogMTksIFwiODZcIiA6IDIwLCBcIjg4XCIgOiAyMSwgXCI5MFwiIDogMjIsIFwiOTFcIiA6IDIzLCBcIjk0XCIgOiAyNCwgXCI5NVwiIDogMjUsIFwiMTA0XCIgOiAyNiwgXCIxMDZcIiA6IDI3LCBcIjEwN1wiIDogMjgsIFwiMTIwXCIgOiAyOSwgXCIxMjJcIiA6IDMwLCBcIjEyM1wiIDogMzEsIFwiMTI2XCIgOiAzMiwgXCIxMjdcIiA6IDMzLCBcIjIwOFwiIDogMzQsIFwiMjEwXCIgOiAzNSwgXCIyMTRcIiA6IDM2LCBcIjIxNlwiIDogMzcsIFwiMjE4XCIgOiAzOCwgXCIyMTlcIiA6IDM5LCBcIjIyMlwiIDogNDAsIFwiMjIzXCIgOiA0MSwgXCIyNDhcIiA6IDQyLCBcIjI1MFwiIDogNDMsIFwiMjUxXCIgOiA0NCwgXCIyNTRcIiA6IDQ1LCBcIjI1NVwiIDogNDYsIFwiMFwiIDogNDcgfTtcbiAgcmV0dXJuIGNvbnZlcnRlclt0b3RhbCArIFwiXCJdO1xufVxuXG5mdW5jdGlvbiBmaWxsTWFwKG1hcCkge1xuICBkdW5nZW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R1bmdlb24nKTtcbiAgZHVuZ2Vvbi5zdHlsZS53aWR0aCA9IChUX1dJRFRIICogVF9DT1VOVCkgKyBcInB4XCI7XG4gIGR1bmdlb24uc3R5bGUuaGVpZ2h0ID0gKFRfV0lEVEggKiBUX0NPVU5UKSArIFwicHhcIjtcblxuICB2YXIgdG9BZGQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgVF9DT1VOVDsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBUX0NPVU5UOyBqKyspIHtcbiAgICAgICB2YXIgbmV3RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgbmV3RGl2LmlkID0gaiArIFwiX1wiICsgaTtcbiAgICAgICBuZXdEaXYuY2xhc3NOYW1lID0gJ2R1bmdlb25UaWxlJztcbiAgICAgICBuZXdEaXYuc3R5bGUud2lkdGggPSBUX1dJRFRIICsgXCJweFwiO1xuICAgICAgIG5ld0Rpdi5zdHlsZS5oZWlnaHQgPSBUX1dJRFRIICsgXCJweFwiO1xuICAgICAgIGlmIChtYXAuZ2V0VGlsZShqLCBpKSA+IDApIHtcbiAgICAgICAgIG5ld0Rpdi5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybCgnc3RhdGljL2ltZy90aWxlcy9cIiArIGdldE1hc2soaiwgaSkgKyBcIi5wbmcnKVwiO1xuICAgICAgIH1cbiAgICAgICBuZXdEaXYuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG1vdmVIZXJlKTtcbiAgICAgICBuZXdEaXYuZGF0YXNldC54ID0gajtcbiAgICAgICBuZXdEaXYuZGF0YXNldC55ID0gaTtcbiAgICAgICB0b0FkZC5hcHBlbmRDaGlsZChuZXdEaXYpO1xuICAgIH1cbiAgfVxuICBkdW5nZW9uLmFwcGVuZENoaWxkKHRvQWRkKTtcbn1cblxuZnVuY3Rpb24gYWRkUGxheWVyKCkge1xuICBkdW5nZW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R1bmdlb24nKTtcbiAgdmFyIHBsYXllckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBwbGF5ZXJEaXYuaWQgPSAncGxheWVyJztcbiAgcGxheWVyRGl2LmNsYXNzTmFtZSA9ICdkdW5nZW9uT2JqZWN0JztcbiAgcGxheWVyRGl2LnN0eWxlLndpZHRoID0gVF9XSURUSCArIFwicHhcIjtcbiAgcGxheWVyRGl2LnN0eWxlLmhlaWdodCA9IFRfV0lEVEggKyBcInB4XCI7XG4gIHBsYXllckRpdi5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybCgnc3RhdGljL2ltZy92ZWxiaXJkLnBuZycpXCI7XG4gIHBsYXllckRpdi5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9ICBUX1dJRFRIICsgXCJweCBcIiArIFRfV0lEVEggKyBcInB4IFwiO1xuICBkdW5nZW9uLmFwcGVuZENoaWxkKHBsYXllckRpdik7XG59XG5cbmZ1bmN0aW9uIG1vdmVQbGF5ZXIoeCwgeSkge1xuICB2YXIgcGxheWVyRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllcicpO1xuICBpZiAobWFwLmdldFRpbGUocGxheWVyLnggKyB4LCBwbGF5ZXIueSArIHkpID09IDEpIHtcbiAgICBwbGF5ZXIueCArPSB4O1xuICAgIHBsYXllci55ICs9IHk7XG4gICAgcGxheWVyRGl2LnN0eWxlLmxlZnQgPSAgKHBsYXllci54ICogVF9XSURUSCkgKyBcInB4XCI7XG4gICAgcGxheWVyRGl2LnN0eWxlLnRvcCA9ICAocGxheWVyLnkgKiBUX1dJRFRIIC0gUExBWUVSX09GRlNFVCkgKyBcInB4XCI7XG4gIH1cbn1cblxuZG9jdW1lbnQub25rZXlkb3duID0gY2hlY2tLZXk7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbihlKSB7XG4gICAgLy8gc3BhY2UgYW5kIGFycm93IGtleXNcbiAgICBpZihbMzIsIDM3LCAzOCwgMzksIDQwXS5pbmRleE9mKGUua2V5Q29kZSkgPiAtMSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxufSwgZmFsc2UpO1xuXG5mdW5jdGlvbiBjaGVja0tleShlKSB7XG5cbiAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG5cbiAgICBpZiAoZS5rZXlDb2RlID09ICczOCcgfHwgZS5rZXlDb2RlID09ICc4NycpIHtcbiAgICAgICAgLy8gdXAgYXJyb3dcbiAgICAgICAgbW92ZVBsYXllcigwLCAtMSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGUua2V5Q29kZSA9PSAnNDAnIHx8IGUua2V5Q29kZSA9PSAnODMnKSB7XG4gICAgICAgIC8vIGRvd24gYXJyb3dcbiAgICAgICAgbW92ZVBsYXllcigwLCAxKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZS5rZXlDb2RlID09ICczNycgfHwgZS5rZXlDb2RlID09ICc2NScpIHtcbiAgICAgICAvLyBsZWZ0IGFycm93XG4gICAgICAgbW92ZVBsYXllcigtMSwgMCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGUua2V5Q29kZSA9PSAnMzknIHx8IGUua2V5Q29kZSA9PSAnNjgnKSB7XG4gICAgICAgLy8gcmlnaHQgYXJyb3dcbiAgICAgICBtb3ZlUGxheWVyKDEsIDApO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbW92ZUhlcmUgKCkge1xuICBpZiAoTWF0aC5hYnModGhpcy5kYXRhc2V0LnggLSBwbGF5ZXIueCkgPiAgTWF0aC5hYnModGhpcy5kYXRhc2V0LnkgLSBwbGF5ZXIueSkpIHtcbiAgICBpZiAodGhpcy5kYXRhc2V0LnggLSBwbGF5ZXIueCA+IDApIHtcbiAgICAgIG1vdmVQbGF5ZXIoMSwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1vdmVQbGF5ZXIoLTEsIDApO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAodGhpcy5kYXRhc2V0LnkgLSBwbGF5ZXIueSA+IDApIHtcbiAgICAgIG1vdmVQbGF5ZXIoMCwgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1vdmVQbGF5ZXIoMCwgLTEpO1xuICAgIH1cbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
