function init(){getMap(),setButton()}function getMap(){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=JSON.parse(e.responseText);map.tiles=t.map,fillMap(map),addPlayer(t.player.x,t.player.y)}},e.open("GET","api/dungeon",!0),e.send()}function getMask(e,t){var a=0,n=2*(map.getTile(e,t-1)||0),o=8*(map.getTile(e-1,t)||0),l=16*(map.getTile(e+1,t)||0),d=64*(map.getTile(e,t+1)||0);a+=n+o+l+d,n>0&&o>0&&(a+=map.getTile(e-1,t-1)||0),n>0&&l>0&&(a+=4*(map.getTile(e+1,t-1)||0)),d>0&&o>0&&(a+=32*(map.getTile(e-1,t+1)||0)),d>0&&l>0&&(a+=128*(map.getTile(e+1,t+1)||0));var i={2:1,8:2,10:3,11:4,16:5,18:6,22:7,24:8,26:9,27:10,30:11,31:12,64:13,66:14,72:15,74:16,75:17,80:18,82:19,86:20,88:21,90:22,91:23,94:24,95:25,104:26,106:27,107:28,120:29,122:30,123:31,126:32,127:33,208:34,210:35,214:36,216:37,218:38,219:39,222:40,223:41,248:42,250:43,251:44,254:45,255:46,0:47};return i[a+""]}function fillMap(e){dungeon=document.getElementById("dungeon"),dungeon.style.width="640px",dungeon.style.height="512px";for(var t=document.createDocumentFragment(),a=0;T_COUNTY>a;a++)for(var n=0;T_COUNTX>n;n++){var o=document.createElement("div");o.id=n+"_"+a,o.className="dungeonTile",o.style.width="64px",o.style.height="64px",e.getTile(n,a)>0&&(o.style.backgroundImage="url('static/img/tiles/"+getMask(n,a)+".png')"),o.addEventListener("click",moveHere),o.dataset.x=n,o.dataset.y=a,t.appendChild(o)}dungeon.appendChild(t)}function addPlayer(e,t){dungeon=document.getElementById("dungeon");var a=document.createElement("div");a.id="player",a.className="dungeonObject",a.style.width="64px",a.style.height="64px",a.style.backgroundImage="url('static/img/SHC.png')",a.style.backgroundSize="64px 64px ",dungeon.appendChild(a),movePlayer(e,t)}function movePlayer(e,t){var a=document.getElementById("player");1==map.getTile(player.x+e,player.y+t)&&(player.x+=e,player.y+=t,a.style.left=player.x*T_WIDTH+"px",a.style.top=player.y*T_WIDTH-PLAYER_OFFSET+"px")}function checkKey(e){e=e||window.event,"38"==e.keyCode||"87"==e.keyCode?movePlayer(0,-1):"40"==e.keyCode||"83"==e.keyCode?movePlayer(0,1):"37"==e.keyCode||"65"==e.keyCode?movePlayer(-1,0):"39"!=e.keyCode&&"68"!=e.keyCode||movePlayer(1,0)}function moveHere(){Math.abs(this.dataset.x-player.x)>Math.abs(this.dataset.y-player.y)?this.dataset.x-player.x>0?movePlayer(1,0):movePlayer(-1,0):this.dataset.y-player.y>0?movePlayer(0,1):movePlayer(0,-1)}function setButton(){tButton=document.getElementById("tButton"),tButton.onclick=demoAjax}function demoAjax(){var e=new XMLHttpRequest;e.onreadystatechange=function(){4==e.readyState&&200==e.status&&(document.getElementById("demo").innerHTML=e.responseText)},e.open("GET","api/test",!0),e.send()}window.onload=init;const T_WIDTH=64,T_COUNTX=10,T_COUNTY=8,TILE_LOC="static/img/tiles/",PLAYER_OFFSET=20;var map={cols:T_COUNTX,rows:T_COUNTY,tsize:T_WIDTH,tiles:[1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,1,0,1,0,1,1,0,1,0,1,1,0,1,1,0,1,0,1,1,1,1,0,1,0,0,1,1,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,1,1,1,1,0,0,1,1,0,0,1,0,1,0,0,0,0,0,0,0,1],getTile:function(e,t){return e>map.cols-1||t>map.rows-1||0>t||0>e?0:this.tiles[t*map.cols+e]}},player={x:0,y:0};document.onkeydown=checkKey,window.addEventListener("keydown",function(e){[32,37,38,39,40].indexOf(e.keyCode)>-1&&e.preventDefault()},!1);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImR1bmdlb24uanMiXSwibmFtZXMiOlsiaW5pdCIsImdldE1hcCIsInNldEJ1dHRvbiIsInhodHRwIiwiWE1MSHR0cFJlcXVlc3QiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwianNvbkRhdGEiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJtYXAiLCJ0aWxlcyIsImZpbGxNYXAiLCJhZGRQbGF5ZXIiLCJwbGF5ZXIiLCJ4IiwieSIsIm9wZW4iLCJzZW5kIiwiZ2V0TWFzayIsInRvdGFsIiwibm9ydGgiLCJnZXRUaWxlIiwid2VzdCIsImVhc3QiLCJzb3V0aCIsImNvbnZlcnRlciIsIjIiLCI4IiwiMTAiLCIxMSIsIjE2IiwiMTgiLCIyMiIsIjI0IiwiMjYiLCIyNyIsIjMwIiwiMzEiLCI2NCIsIjY2IiwiNzIiLCI3NCIsIjc1IiwiODAiLCI4MiIsIjg2IiwiODgiLCI5MCIsIjkxIiwiOTQiLCI5NSIsIjEwNCIsIjEwNiIsIjEwNyIsIjEyMCIsIjEyMiIsIjEyMyIsIjEyNiIsIjEyNyIsIjIwOCIsIjIxMCIsIjIxNCIsIjIxNiIsIjIxOCIsIjIxOSIsIjIyMiIsIjIyMyIsIjI0OCIsIjI1MCIsIjI1MSIsIjI1NCIsIjI1NSIsIjAiLCJkdW5nZW9uIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJ0b0FkZCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpIiwiVF9DT1VOVFkiLCJqIiwiVF9DT1VOVFgiLCJuZXdEaXYiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJjbGFzc05hbWUiLCJUX1dJRFRIIiwiYmFja2dyb3VuZEltYWdlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm1vdmVIZXJlIiwiZGF0YXNldCIsImFwcGVuZENoaWxkIiwicGxheWVyRGl2IiwiYmFja2dyb3VuZFNpemUiLCJtb3ZlUGxheWVyIiwibGVmdCIsInRvcCIsIlBMQVlFUl9PRkZTRVQiLCJjaGVja0tleSIsImUiLCJ3aW5kb3ciLCJldmVudCIsImtleUNvZGUiLCJNYXRoIiwiYWJzIiwidGhpcyIsInRCdXR0b24iLCJvbmNsaWNrIiwiZGVtb0FqYXgiLCJpbm5lckhUTUwiLCJvbmxvYWQiLCJUSUxFX0xPQyIsImNvbHMiLCJyb3dzIiwidHNpemUiLCJjb2wiLCJyb3ciLCJvbmtleWRvd24iLCJpbmRleE9mIiwicHJldmVudERlZmF1bHQiXSwibWFwcGluZ3MiOiJBQUVBLFFBQVNBLFFBQ1BDLFNBQ0FDLFlBZ0NGLFFBQVNELFVBQ1AsR0FBSUUsR0FBUSxHQUFJQyxlQUNoQkQsR0FBTUUsbUJBQXFCLFdBQ3pCLEdBQXdCLEdBQXBCRixFQUFNRyxZQUFtQyxLQUFoQkgsRUFBTUksT0FBZSxDQUNoRCxHQUFJQyxHQUFXQyxLQUFLQyxNQUFNUCxFQUFNUSxhQUNoQ0MsS0FBSUMsTUFBUUwsRUFBU0ksSUFDckJFLFFBQVFGLEtBQ1JHLFVBQVVQLEVBQVNRLE9BQU9DLEVBQUdULEVBQVNRLE9BQU9FLEtBR2pEZixFQUFNZ0IsS0FBSyxNQUFPLGVBQWUsR0FDakNoQixFQUFNaUIsT0FTUixRQUFTQyxTQUFRSixFQUFHQyxHQUNsQixHQUFJSSxHQUFRLEVBQ1JDLEVBQVMsR0FBS1gsSUFBSVksUUFBUVAsRUFBR0MsRUFBSSxJQUFNLEdBQ3ZDTyxFQUFPLEdBQUtiLElBQUlZLFFBQVFQLEVBQUksRUFBR0MsSUFBTSxHQUNyQ1EsRUFBTyxJQUFNZCxJQUFJWSxRQUFRUCxFQUFJLEVBQUdDLElBQU0sR0FDdENTLEVBQVEsSUFBTWYsSUFBSVksUUFBUVAsRUFBR0MsRUFBSSxJQUFNLEVBQzNDSSxJQUFTQyxFQUFRRSxFQUFPQyxFQUFPQyxFQUMzQkosRUFBUSxHQUFLRSxFQUFPLElBQ3RCSCxHQUFVVixJQUFJWSxRQUFRUCxFQUFJLEVBQUdDLEVBQUksSUFBTSxHQUVyQ0ssRUFBUSxHQUFLRyxFQUFPLElBQ3RCSixHQUFTLEdBQUtWLElBQUlZLFFBQVFQLEVBQUksRUFBR0MsRUFBSSxJQUFNLElBRXpDUyxFQUFR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QUcsRUFDM0IsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDM0IsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDM0IsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDM0IsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDM0IsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDM0IsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsR0FFN0JXLFFBQVMsU0FBU2lHLEVBQUtDLEdBQ3JCLE1BQUlELEdBQU03RyxJQUFJMEcsS0FBTyxHQUFLSSxFQUFNOUcsSUFBSTJHLEtBQU8sR0FBVyxFQUFORyxHQUFpQixFQUFORCxFQUNsRCxFQUVGVixLQUFLbEcsTUFBTTZHLEVBQU05RyxJQUFJMEcsS0FBT0csS0FrQm5DekcsUUFDRkMsRUFBRyxFQUNIQyxFQUFHLEVBMkVMMkQsVUFBUzhDLFVBQVluQixTQUVyQkUsT0FBT1osaUJBQWlCLFVBQVcsU0FBU1csSUFFcEMsR0FBSSxHQUFJLEdBQUksR0FBSSxJQUFJbUIsUUFBUW5CLEVBQUVHLFNBQVcsSUFDekNILEVBQUVvQixtQkFFUCIsImZpbGUiOiJkdW5nZW9uLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIndpbmRvdy5vbmxvYWQgPSBpbml0O1xuXG5mdW5jdGlvbiBpbml0KCkge1xuICBnZXRNYXAoKTtcbiAgc2V0QnV0dG9uKCk7XG59XG5cbmNvbnN0IFRfV0lEVEggPSA2NDtcbmNvbnN0IFRfQ09VTlRYID0gMTA7XG5jb25zdCBUX0NPVU5UWSA9IDg7XG5jb25zdCBUSUxFX0xPQyA9IFwic3RhdGljL2ltZy90aWxlcy9cIlxuY29uc3QgUExBWUVSX09GRlNFVCA9IDIwO1xuXG5cbnZhciBtYXAgPSB7XG4gIGNvbHM6IFRfQ09VTlRYLFxuICByb3dzOiBUX0NPVU5UWSxcbiAgdHNpemU6IFRfV0lEVEgsXG4gIHRpbGVzOiBbXG4gICAgMSwgMSwgMCwgMCwgMCwgMSwgMSwgMSwgMSwgMSxcbiAgICAxLCAxLCAxLCAxLCAxLCAwLCAwLCAxLCAwLCAxLFxuICAgIDAsIDEsIDEsIDAsIDEsIDAsIDEsIDEsIDAsIDEsXG4gICAgMSwgMCwgMSwgMCwgMSwgMSwgMSwgMSwgMCwgMSxcbiAgICAwLCAwLCAxLCAxLCAwLCAxLCAwLCAxLCAxLCAxLFxuICAgIDAsIDEsIDEsIDEsIDEsIDEsIDEsIDAsIDAsIDEsXG4gICAgMSwgMSwgMSwgMCwgMCwgMSwgMSwgMCwgMCwgMSxcbiAgICAwLCAxLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAxXG4gIF0sXG4gIGdldFRpbGU6IGZ1bmN0aW9uKGNvbCwgcm93KSB7XG4gICAgaWYgKGNvbCA+IG1hcC5jb2xzIC0gMSB8fCByb3cgPiBtYXAucm93cyAtIDEgfHwgcm93IDwgMCB8fCBjb2wgPCAwKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudGlsZXNbcm93ICogbWFwLmNvbHMgKyBjb2xdO1xuICB9XG59O1xuXG5mdW5jdGlvbiBnZXRNYXAgKCkge1xuICB2YXIgeGh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgeGh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHhodHRwLnJlYWR5U3RhdGUgPT0gNCAmJiB4aHR0cC5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICB2YXIganNvbkRhdGEgPSBKU09OLnBhcnNlKHhodHRwLnJlc3BvbnNlVGV4dCk7XG4gICAgICBtYXAudGlsZXMgPSBqc29uRGF0YS5tYXA7XG4gICAgICBmaWxsTWFwKG1hcCk7XG4gICAgICBhZGRQbGF5ZXIoanNvbkRhdGEucGxheWVyLngsIGpzb25EYXRhLnBsYXllci55KTtcbiAgICB9XG4gIH07XG4gIHhodHRwLm9wZW4oXCJHRVRcIiwgXCJhcGkvZHVuZ2VvblwiLCB0cnVlKTtcbiAgeGh0dHAuc2VuZCgpO1xufVxuXG52YXIgcGxheWVyID0ge1xuICB4OiAwLFxuICB5OiAwXG59O1xuXG5cbmZ1bmN0aW9uIGdldE1hc2soeCwgeSkge1xuICB2YXIgdG90YWwgPSAwO1xuICB2YXIgbm9ydGggPSAgMiAqIChtYXAuZ2V0VGlsZSh4LCB5IC0gMSkgfHwgMCk7XG4gIHZhciB3ZXN0ID0gOCAqIChtYXAuZ2V0VGlsZSh4IC0gMSwgeSkgfHwgMCk7XG4gIHZhciBlYXN0ID0gMTYgKiAobWFwLmdldFRpbGUoeCArIDEsIHkpIHx8IDApO1xuICB2YXIgc291dGggPSA2NCAqIChtYXAuZ2V0VGlsZSh4LCB5ICsgMSkgfHwgMCk7XG4gIHRvdGFsICs9IG5vcnRoICsgd2VzdCArIGVhc3QgKyBzb3V0aDtcbiAgaWYgKG5vcnRoID4gMCAmJiB3ZXN0ID4gMCkge1xuICAgIHRvdGFsICs9IChtYXAuZ2V0VGlsZSh4IC0gMSwgeSAtIDEpIHx8IDApO1xuICB9XG4gIGlmIChub3J0aCA+IDAgJiYgZWFzdCA+IDApIHtcbiAgICB0b3RhbCArPSA0ICogKG1hcC5nZXRUaWxlKHggKyAxLCB5IC0gMSkgfHwgMCk7XG4gIH1cbiAgaWYgKHNvdXRoID4gMCAmJiB3ZXN0ID4gMCkge1xuICAgIHRvdGFsICs9IDMyICogKG1hcC5nZXRUaWxlKHggLSAxLCB5ICsgMSkgfHwgMCk7XG4gIH1cbiAgaWYgKHNvdXRoID4gMCAmJiBlYXN0ID4gMCkge1xuICAgIHRvdGFsICs9IDEyOCAqIChtYXAuZ2V0VGlsZSh4ICsgMSwgeSArIDEpIHx8IDApO1xuICB9XG4gIHZhciBjb252ZXJ0ZXIgPSB7IFwiMlwiIDogMSwgXCI4XCIgOiAyLCBcIjEwXCIgOiAzLCBcIjExXCIgOiA0LCBcIjE2XCIgOiA1LCBcIjE4XCIgOiA2LCBcIjIyXCIgOiA3LCBcIjI0XCIgOiA4LCBcIjI2XCIgOiA5LCBcIjI3XCIgOiAxMCwgXCIzMFwiIDogMTEsIFwiMzFcIiA6IDEyLCBcIjY0XCIgOiAxMywgXCI2NlwiIDogMTQsIFwiNzJcIiA6IDE1LCBcIjc0XCIgOiAxNiwgXCI3NVwiIDogMTcsIFwiODBcIiA6IDE4LCBcIjgyXCIgOiAxOSwgXCI4NlwiIDogMjAsIFwiODhcIiA6IDIxLCBcIjkwXCIgOiAyMiwgXCI5MVwiIDogMjMsIFwiOTRcIiA6IDI0LCBcIjk1XCIgOiAyNSwgXCIxMDRcIiA6IDI2LCBcIjEwNlwiIDogMjcsIFwiMTA3XCIgOiAyOCwgXCIxMjBcIiA6IDI5LCBcIjEyMlwiIDogMzAsIFwiMTIzXCIgOiAzMSwgXCIxMjZcIiA6IDMyLCBcIjEyN1wiIDogMzMsIFwiMjA4XCIgOiAzNCwgXCIyMTBcIiA6IDM1LCBcIjIxNFwiIDogMzYsIFwiMjE2XCIgOiAzNywgXCIyMThcIiA6IDM4LCBcIjIxOVwiIDogMzksIFwiMjIyXCIgOiA0MCwgXCIyMjNcIiA6IDQxLCBcIjI0OFwiIDogNDIsIFwiMjUwXCIgOiA0MywgXCIyNTFcIiA6IDQ0LCBcIjI1NFwiIDogNDUsIFwiMjU1XCIgOiA0NiwgXCIwXCIgOiA0NyB9O1xuICByZXR1cm4gY29udmVydGVyW3RvdGFsICsgXCJcIl07XG59XG5cbmZ1bmN0aW9uIGZpbGxNYXAobWFwKSB7XG4gIGR1bmdlb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHVuZ2VvbicpO1xuICBkdW5nZW9uLnN0eWxlLndpZHRoID0gKFRfV0lEVEggKiBUX0NPVU5UWCkgKyBcInB4XCI7XG4gIGR1bmdlb24uc3R5bGUuaGVpZ2h0ID0gKFRfV0lEVEggKiBUX0NPVU5UWSkgKyBcInB4XCI7XG5cbiAgdmFyIHRvQWRkID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IFRfQ09VTlRZOyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IFRfQ09VTlRYOyBqKyspIHtcbiAgICAgICB2YXIgbmV3RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgbmV3RGl2LmlkID0gaiArIFwiX1wiICsgaTtcbiAgICAgICBuZXdEaXYuY2xhc3NOYW1lID0gJ2R1bmdlb25UaWxlJztcbiAgICAgICBuZXdEaXYuc3R5bGUud2lkdGggPSBUX1dJRFRIICsgXCJweFwiO1xuICAgICAgIG5ld0Rpdi5zdHlsZS5oZWlnaHQgPSBUX1dJRFRIICsgXCJweFwiO1xuICAgICAgIGlmIChtYXAuZ2V0VGlsZShqLCBpKSA+IDApIHtcbiAgICAgICAgIG5ld0Rpdi5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybCgnc3RhdGljL2ltZy90aWxlcy9cIiArIGdldE1hc2soaiwgaSkgKyBcIi5wbmcnKVwiO1xuICAgICAgIH1cbiAgICAgICBuZXdEaXYuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG1vdmVIZXJlKTtcbiAgICAgICBuZXdEaXYuZGF0YXNldC54ID0gajtcbiAgICAgICBuZXdEaXYuZGF0YXNldC55ID0gaTtcbiAgICAgICB0b0FkZC5hcHBlbmRDaGlsZChuZXdEaXYpO1xuICAgIH1cbiAgfVxuICBkdW5nZW9uLmFwcGVuZENoaWxkKHRvQWRkKTtcbn1cblxuZnVuY3Rpb24gYWRkUGxheWVyKHgsIHkpIHtcbiAgZHVuZ2VvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkdW5nZW9uJyk7XG4gIHZhciBwbGF5ZXJEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgcGxheWVyRGl2LmlkID0gJ3BsYXllcic7XG4gIHBsYXllckRpdi5jbGFzc05hbWUgPSAnZHVuZ2Vvbk9iamVjdCc7XG4gIHBsYXllckRpdi5zdHlsZS53aWR0aCA9IFRfV0lEVEggKyBcInB4XCI7XG4gIHBsYXllckRpdi5zdHlsZS5oZWlnaHQgPSBUX1dJRFRIICsgXCJweFwiO1xuICBwbGF5ZXJEaXYuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoJ3N0YXRpYy9pbWcvU0hDLnBuZycpXCI7XG4gIHBsYXllckRpdi5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9ICBUX1dJRFRIICsgXCJweCBcIiArIFRfV0lEVEggKyBcInB4IFwiO1xuICBkdW5nZW9uLmFwcGVuZENoaWxkKHBsYXllckRpdik7XG4gIG1vdmVQbGF5ZXIoeCwgeSk7XG59XG5cbmZ1bmN0aW9uIG1vdmVQbGF5ZXIoeCwgeSkge1xuICB2YXIgcGxheWVyRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllcicpO1xuICBpZiAobWFwLmdldFRpbGUocGxheWVyLnggKyB4LCBwbGF5ZXIueSArIHkpID09IDEpIHtcbiAgICBwbGF5ZXIueCArPSB4O1xuICAgIHBsYXllci55ICs9IHk7XG4gICAgcGxheWVyRGl2LnN0eWxlLmxlZnQgPSAgKHBsYXllci54ICogVF9XSURUSCkgKyBcInB4XCI7XG4gICAgcGxheWVyRGl2LnN0eWxlLnRvcCA9ICAocGxheWVyLnkgKiBUX1dJRFRIIC0gUExBWUVSX09GRlNFVCkgKyBcInB4XCI7XG4gIH1cbn1cblxuZG9jdW1lbnQub25rZXlkb3duID0gY2hlY2tLZXk7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbihlKSB7XG4gICAgLy8gc3BhY2UgYW5kIGFycm93IGtleXNcbiAgICBpZihbMzIsIDM3LCAzOCwgMzksIDQwXS5pbmRleE9mKGUua2V5Q29kZSkgPiAtMSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxufSwgZmFsc2UpO1xuXG5mdW5jdGlvbiBjaGVja0tleShlKSB7XG5cbiAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG5cbiAgICBpZiAoZS5rZXlDb2RlID09ICczOCcgfHwgZS5rZXlDb2RlID09ICc4NycpIHtcbiAgICAgICAgLy8gdXAgYXJyb3dcbiAgICAgICAgbW92ZVBsYXllcigwLCAtMSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGUua2V5Q29kZSA9PSAnNDAnIHx8IGUua2V5Q29kZSA9PSAnODMnKSB7XG4gICAgICAgIC8vIGRvd24gYXJyb3dcbiAgICAgICAgbW92ZVBsYXllcigwLCAxKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZS5rZXlDb2RlID09ICczNycgfHwgZS5rZXlDb2RlID09ICc2NScpIHtcbiAgICAgICAvLyBsZWZ0IGFycm93XG4gICAgICAgbW92ZVBsYXllcigtMSwgMCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGUua2V5Q29kZSA9PSAnMzknIHx8IGUua2V5Q29kZSA9PSAnNjgnKSB7XG4gICAgICAgLy8gcmlnaHQgYXJyb3dcbiAgICAgICBtb3ZlUGxheWVyKDEsIDApO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbW92ZUhlcmUgKCkge1xuICBpZiAoTWF0aC5hYnModGhpcy5kYXRhc2V0LnggLSBwbGF5ZXIueCkgPiAgTWF0aC5hYnModGhpcy5kYXRhc2V0LnkgLSBwbGF5ZXIueSkpIHtcbiAgICBpZiAodGhpcy5kYXRhc2V0LnggLSBwbGF5ZXIueCA+IDApIHtcbiAgICAgIG1vdmVQbGF5ZXIoMSwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1vdmVQbGF5ZXIoLTEsIDApO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAodGhpcy5kYXRhc2V0LnkgLSBwbGF5ZXIueSA+IDApIHtcbiAgICAgIG1vdmVQbGF5ZXIoMCwgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1vdmVQbGF5ZXIoMCwgLTEpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBzZXRCdXR0b24oKSB7XG4gIHRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRCdXR0b25cIik7XG4gIHRCdXR0b24ub25jbGljayA9IGRlbW9BamF4O1xufVxuXG5mdW5jdGlvbiBkZW1vQWpheCgpIHtcbiAgdmFyIHhodHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gIHhodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh4aHR0cC5yZWFkeVN0YXRlID09IDQgJiYgeGh0dHAuc3RhdHVzID09IDIwMCkge1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkZW1vXCIpLmlubmVySFRNTCA9IHhodHRwLnJlc3BvbnNlVGV4dDtcbiAgICB9XG4gIH07XG4gIHhodHRwLm9wZW4oXCJHRVRcIiwgXCJhcGkvdGVzdFwiLCB0cnVlKTtcbiAgeGh0dHAuc2VuZCgpO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
