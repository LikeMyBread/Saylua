function init(){getMap()}function getMap(){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=JSON.parse(e.responseText);map.tiles=t.map,fillMap(map),addPlayer(t.player.x,t.player.y)}},e.open("GET","/api/explore/map/",!0),e.send()}function fillMap(e){dungeon=document.getElementById("dungeon"),dungeon.style.width="640px",dungeon.style.height="512px";for(var t=document.createDocumentFragment(),a=0;a<T_COUNTY;a++)for(var y=0;y<T_COUNTX;y++){var n=document.createElement("div");n.id=y+"_"+a,n.className="dungeonTile",n.style.width="64px",n.style.height="64px",e.getTile(y,a)>0&&(n.style.backgroundColor="#DEB887"),n.addEventListener("click",findPath),n.dataset.x=y,n.dataset.y=a,t.appendChild(n)}dungeon.appendChild(t)}function addPlayer(e,t){dungeon=document.getElementById("dungeon");var a=document.createElement("div");a.id="player",a.className="dungeonObject",a.style.width="64px",a.style.height="64px",a.style.backgroundImage="url('/static/img/SHC.png')",a.style.backgroundSize="64px 64px ",dungeon.appendChild(a),movePlayer(e,t)}function movePlayer(e,t){var a=document.getElementById("player");1==map.getTile(player.x+e,player.y+t)&&(player.x+=e,player.y+=t,a.style.left=player.x*T_WIDTH+"px",a.style.top=player.y*T_WIDTH-PLAYER_OFFSET+"px")}function checkKey(e){e=e||window.event,"38"==e.keyCode||"87"==e.keyCode?movePlayer(0,-1):"40"==e.keyCode||"83"==e.keyCode?movePlayer(0,1):"37"==e.keyCode||"65"==e.keyCode?movePlayer(-1,0):"39"!=e.keyCode&&"68"!=e.keyCode||movePlayer(1,0)}function moveHere(){Math.abs(this.dataset.x-player.x)>Math.abs(this.dataset.y-player.y)?this.dataset.x-player.x>0?movePlayer(1,0):movePlayer(-1,0):this.dataset.y-player.y>0?movePlayer(0,1):movePlayer(0,-1)}function findPath(){if(player.x!=this.dataset.x||player.y!=this.dataset.y)for(var e=[{x:this.dataset.x,y:this.dataset.y}],t=[];e.length>0;){var a=e.shift();if(t.push(1*a.x+10*a.y),player.x==a.x-1&&player.y==a.y)return void movePlayer(1,0);if(player.x==1*a.x+1&&player.y==a.y)return void movePlayer(-1,0);if(player.x==1*a.x&&player.y==a.y-1)return void movePlayer(0,1);if(player.x==1*a.x&&player.y==1*a.y+1)return void movePlayer(0,-1);0!=map.getTile(1*a.x-1,1*a.y)&&t.indexOf(1*a.x-1+10*a.y)==-1&&e.push({x:1*a.x-1,y:1*a.y}),0!=map.getTile(1*a.x+1,1*a.y)&&t.indexOf(1*a.x+1+10*a.y)==-1&&e.push({x:1*a.x+1,y:1*a.y}),0!=map.getTile(1*a.x,1*a.y-1)&&t.indexOf(1*a.x+10*(1*a.y-1))==-1&&e.push({x:1*a.x,y:1*a.y-1}),0!=map.getTile(1*a.x,1*a.y+1)&&t.indexOf(1*a.x+10*(1*a.y+1))==-1&&e.push({x:1*a.x,y:1*a.y+1})}}window.addEventListener("load",init);const T_WIDTH=64,T_COUNTX=10,T_COUNTY=8,TILE_LOC="/static/img/tiles/",PLAYER_OFFSET=0;var map={cols:T_COUNTX,rows:T_COUNTY,tsize:T_WIDTH,tiles:new Array(80),getTile:function(e,t){return e>map.cols-1||t>map.rows-1||t<0||e<0?0:this.tiles[t*map.cols+e]}},player={x:0,y:0};window.addEventListener("keydown",function(e){document.activeElement&&document.activeElement!=document.body||([37,38,39,40].indexOf(e.keyCode)>-1&&e.preventDefault(),checkKey())},!1);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImR1bmdlb24uanMiXSwibmFtZXMiOlsiaW5pdCIsImdldE1hcCIsInhodHRwIiwiWE1MSHR0cFJlcXVlc3QiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwianNvbkRhdGEiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJtYXAiLCJ0aWxlcyIsImZpbGxNYXAiLCJhZGRQbGF5ZXIiLCJwbGF5ZXIiLCJ4IiwieSIsIm9wZW4iLCJzZW5kIiwiZHVuZ2VvbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsIndpZHRoIiwiaGVpZ2h0IiwidG9BZGQiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwiaSIsIlRfQ09VTlRZIiwiaiIsIlRfQ09VTlRYIiwibmV3RGl2IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY2xhc3NOYW1lIiwiVF9XSURUSCIsImdldFRpbGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJhZGRFdmVudExpc3RlbmVyIiwiZmluZFBhdGgiLCJkYXRhc2V0IiwiYXBwZW5kQ2hpbGQiLCJwbGF5ZXJEaXYiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJiYWNrZ3JvdW5kU2l6ZSIsIm1vdmVQbGF5ZXIiLCJsZWZ0IiwidG9wIiwiUExBWUVSX09GRlNFVCIsImNoZWNrS2V5IiwiZSIsIndpbmRvdyIsImV2ZW50Iiwia2V5Q29kZSIsIm1vdmVIZXJlIiwiTWF0aCIsImFicyIsInRoaXMiLCJxdWV1ZSIsImNoZWNrZWQiLCJsZW5ndGgiLCJjdXJyZW50TG9jYXRpb24iLCJzaGlmdCIsInB1c2giLCJpbmRleE9mIiwiVElMRV9MT0MiLCJjb2xzIiwicm93cyIsInRzaXplIiwiQXJyYXkiLCJjb2wiLCJyb3ciLCJhY3RpdmVFbGVtZW50IiwiYm9keSIsInByZXZlbnREZWZhdWx0Il0sIm1hcHBpbmdzIjoiQUFFQSxRQUFTQSxRQUNQQyxTQXVCRixRQUFTQSxVQUNQLEdBQUlDLEdBQVEsR0FBSUMsZUFDaEJELEdBQU1F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LGlCQUdOekIsY0FDRCIsImZpbGUiOiJkdW5nZW9uLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBpbml0KTtcblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgZ2V0TWFwKCk7XG59XG5cbmNvbnN0IFRfV0lEVEggPSA2NDtcbmNvbnN0IFRfQ09VTlRYID0gMTA7XG5jb25zdCBUX0NPVU5UWSA9IDg7XG5jb25zdCBUSUxFX0xPQyA9IFwiL3N0YXRpYy9pbWcvdGlsZXMvXCJcbmNvbnN0IFBMQVlFUl9PRkZTRVQgPSAwO1xuXG5cbnZhciBtYXAgPSB7XG4gIGNvbHM6IFRfQ09VTlRYLFxuICByb3dzOiBUX0NPVU5UWSxcbiAgdHNpemU6IFRfV0lEVEgsXG4gIHRpbGVzOiBuZXcgQXJyYXkoVF9DT1VOVFkgKiBUX0NPVU5UWCksXG4gIGdldFRpbGU6IGZ1bmN0aW9uKGNvbCwgcm93KSB7XG4gICAgaWYgKGNvbCA+IG1hcC5jb2xzIC0gMSB8fCByb3cgPiBtYXAucm93cyAtIDEgfHwgcm93IDwgMCB8fCBjb2wgPCAwKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudGlsZXNbcm93ICogbWFwLmNvbHMgKyBjb2xdO1xuICB9XG59O1xuXG5mdW5jdGlvbiBnZXRNYXAgKCkge1xuICB2YXIgeGh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgeGh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHhodHRwLnJlYWR5U3RhdGUgPT0gNCAmJiB4aHR0cC5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICB2YXIganNvbkRhdGEgPSBKU09OLnBhcnNlKHhodHRwLnJlc3BvbnNlVGV4dCk7XG4gICAgICBtYXAudGlsZXMgPSBqc29uRGF0YS5tYXA7XG4gICAgICBmaWxsTWFwKG1hcCk7XG4gICAgICBhZGRQbGF5ZXIoanNvbkRhdGEucGxheWVyLngsIGpzb25EYXRhLnBsYXllci55KTtcbiAgICB9XG4gIH07XG4gIHhodHRwLm9wZW4oXCJHRVRcIiwgXCIvYXBpL2V4cGxvcmUvbWFwL1wiLCB0cnVlKTtcbiAgeGh0dHAuc2VuZCgpO1xufVxuXG52YXIgcGxheWVyID0ge1xuICB4OiAwLFxuICB5OiAwXG59O1xuXG5mdW5jdGlvbiBmaWxsTWFwKG1hcCkge1xuICBkdW5nZW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R1bmdlb24nKTtcbiAgZHVuZ2Vvbi5zdHlsZS53aWR0aCA9IChUX1dJRFRIICogVF9DT1VOVFgpICsgXCJweFwiO1xuICBkdW5nZW9uLnN0eWxlLmhlaWdodCA9IChUX1dJRFRIICogVF9DT1VOVFkpICsgXCJweFwiO1xuXG4gIHZhciB0b0FkZCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBUX0NPVU5UWTsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBUX0NPVU5UWDsgaisrKSB7XG4gICAgICAgdmFyIG5ld0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgIG5ld0Rpdi5pZCA9IGogKyBcIl9cIiArIGk7XG4gICAgICAgbmV3RGl2LmNsYXNzTmFtZSA9ICdkdW5nZW9uVGlsZSc7XG4gICAgICAgbmV3RGl2LnN0eWxlLndpZHRoID0gVF9XSURUSCArIFwicHhcIjtcbiAgICAgICBuZXdEaXYuc3R5bGUuaGVpZ2h0ID0gVF9XSURUSCArIFwicHhcIjtcbiAgICAgICBpZiAobWFwLmdldFRpbGUoaiwgaSkgPiAwKSB7XG4gICAgICAgICBuZXdEaXYuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjREVCODg3XCI7XG4gICAgICAgfVxuICAgICAgIG5ld0Rpdi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZmluZFBhdGgpO1xuICAgICAgIG5ld0Rpdi5kYXRhc2V0LnggPSBqO1xuICAgICAgIG5ld0Rpdi5kYXRhc2V0LnkgPSBpO1xuICAgICAgIHRvQWRkLmFwcGVuZENoaWxkKG5ld0Rpdik7XG4gICAgfVxuICB9XG4gIGR1bmdlb24uYXBwZW5kQ2hpbGQodG9BZGQpO1xufVxuXG5mdW5jdGlvbiBhZGRQbGF5ZXIoeCwgeSkge1xuICBkdW5nZW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R1bmdlb24nKTtcbiAgdmFyIHBsYXllckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBwbGF5ZXJEaXYuaWQgPSAncGxheWVyJztcbiAgcGxheWVyRGl2LmNsYXNzTmFtZSA9ICdkdW5nZW9uT2JqZWN0JztcbiAgcGxheWVyRGl2LnN0eWxlLndpZHRoID0gVF9XSURUSCArIFwicHhcIjtcbiAgcGxheWVyRGl2LnN0eWxlLmhlaWdodCA9IFRfV0lEVEggKyBcInB4XCI7XG4gIHBsYXllckRpdi5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybCgnL3N0YXRpYy9pbWcvU0hDLnBuZycpXCI7XG4gIHBsYXllckRpdi5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9ICBUX1dJRFRIICsgXCJweCBcIiArIFRfV0lEVEggKyBcInB4IFwiO1xuICBkdW5nZW9uLmFwcGVuZENoaWxkKHBsYXllckRpdik7XG4gIG1vdmVQbGF5ZXIoeCwgeSk7XG59XG5cbmZ1bmN0aW9uIG1vdmVQbGF5ZXIoeCwgeSkge1xuICB2YXIgcGxheWVyRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllcicpO1xuICBpZiAobWFwLmdldFRpbGUocGxheWVyLnggKyB4LCBwbGF5ZXIueSArIHkpID09IDEpIHtcbiAgICBwbGF5ZXIueCArPSB4O1xuICAgIHBsYXllci55ICs9IHk7XG4gICAgcGxheWVyRGl2LnN0eWxlLmxlZnQgPSAgKHBsYXllci54ICogVF9XSURUSCkgKyBcInB4XCI7XG4gICAgcGxheWVyRGl2LnN0eWxlLnRvcCA9ICAocGxheWVyLnkgKiBUX1dJRFRIIC0gUExBWUVSX09GRlNFVCkgKyBcInB4XCI7XG4gIH1cbn1cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICE9IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gc3BhY2UgYW5kIGFycm93IGtleXNcbiAgICBpZihbMzcsIDM4LCAzOSwgNDBdLmluZGV4T2YoZS5rZXlDb2RlKSA+IC0xKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBjaGVja0tleSgpO1xufSwgZmFsc2UpO1xuXG5mdW5jdGlvbiBjaGVja0tleShlKSB7XG4gICAgZSA9IGUgfHwgd2luZG93LmV2ZW50O1xuXG4gICAgaWYgKGUua2V5Q29kZSA9PSAnMzgnIHx8IGUua2V5Q29kZSA9PSAnODcnKSB7XG4gICAgICAvLyB1cCBhcnJvd1xuICAgICAgbW92ZVBsYXllcigwLCAtMSk7XG4gICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT0gJzQwJyB8fCBlLmtleUNvZGUgPT0gJzgzJykge1xuICAgICAgLy8gZG93biBhcnJvd1xuICAgICAgbW92ZVBsYXllcigwLCAxKTtcbiAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAnMzcnIHx8IGUua2V5Q29kZSA9PSAnNjUnKSB7XG4gICAgICAgLy8gbGVmdCBhcnJvd1xuICAgICAgIG1vdmVQbGF5ZXIoLTEsIDApO1xuICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09ICczOScgfHwgZS5rZXlDb2RlID09ICc2OCcpIHtcbiAgICAgICAvLyByaWdodCBhcnJvd1xuICAgICAgIG1vdmVQbGF5ZXIoMSwgMCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBtb3ZlSGVyZSAoKSB7XG4gIGlmIChNYXRoLmFicyh0aGlzLmRhdGFzZXQueCAtIHBsYXllci54KSA+ICBNYXRoLmFicyh0aGlzLmRhdGFzZXQueSAtIHBsYXllci55KSkge1xuICAgIGlmICh0aGlzLmRhdGFzZXQueCAtIHBsYXllci54ID4gMCkge1xuICAgICAgbW92ZVBsYXllcigxLCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbW92ZVBsYXllcigtMSwgMCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmICh0aGlzLmRhdGFzZXQueSAtIHBsYXllci55ID4gMCkge1xuICAgICAgbW92ZVBsYXllcigwLCAxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbW92ZVBsYXllcigwLCAtMSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGZpbmRQYXRoKCkge1xuICBpZiAocGxheWVyLnggPT0gdGhpcy5kYXRhc2V0LnggJiYgcGxheWVyLnkgPT0gdGhpcy5kYXRhc2V0LnkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIHF1ZXVlID0gW3t4IDogdGhpcy5kYXRhc2V0LngsIHkgOiB0aGlzLmRhdGFzZXQueX1dO1xuICB2YXIgY2hlY2tlZCA9IFtdO1xuICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgd2hpbGUgKHF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICB2YXIgY3VycmVudExvY2F0aW9uID0gcXVldWUuc2hpZnQoKTtcbiAgICBjaGVja2VkLnB1c2goMSAqIGN1cnJlbnRMb2NhdGlvbi54ICsgMTAgKiBjdXJyZW50TG9jYXRpb24ueSk7XG4gICAgaWYgKHBsYXllci54ID09IGN1cnJlbnRMb2NhdGlvbi54IC0gMSAmJiBwbGF5ZXIueSA9PSBjdXJyZW50TG9jYXRpb24ueSkge1xuICAgICAgbW92ZVBsYXllcigxLCAwKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKHBsYXllci54ID09IDEgKiBjdXJyZW50TG9jYXRpb24ueCArIDEgJiYgcGxheWVyLnkgPT0gY3VycmVudExvY2F0aW9uLnkpIHtcbiAgICAgIG1vdmVQbGF5ZXIoLTEsIDApO1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAocGxheWVyLnggPT0gMSAqIGN1cnJlbnRMb2NhdGlvbi54ICYmIHBsYXllci55ID09IGN1cnJlbnRMb2NhdGlvbi55IC0gMSkge1xuICAgICAgbW92ZVBsYXllcigwLCAxKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKHBsYXllci54ID09IDEgKiBjdXJyZW50TG9jYXRpb24ueCAmJiBwbGF5ZXIueSA9PSAxICogY3VycmVudExvY2F0aW9uLnkgKyAxKSB7XG4gICAgICBtb3ZlUGxheWVyKDAsIC0xKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKChtYXAuZ2V0VGlsZSgxICogY3VycmVudExvY2F0aW9uLnggLSAxLCAxICogY3VycmVudExvY2F0aW9uLnkpICE9IDApICYmIGNoZWNrZWQuaW5kZXhPZigxICogY3VycmVudExvY2F0aW9uLnggLSAxICsgMTAgKiBjdXJyZW50TG9jYXRpb24ueSkgPT0gLTEpIHtcbiAgICAgICAgcXVldWUucHVzaCh7eCA6IDEgKiBjdXJyZW50TG9jYXRpb24ueCAtIDEsIHkgOiAxICogY3VycmVudExvY2F0aW9uLnl9KTtcbiAgICB9XG4gICAgaWYgKChtYXAuZ2V0VGlsZSgxICogY3VycmVudExvY2F0aW9uLnggKyAxLCAxICogY3VycmVudExvY2F0aW9uLnkpICE9IDApICYmIGNoZWNrZWQuaW5kZXhPZigxICogY3VycmVudExvY2F0aW9uLnggKyAxICsgMTAgKiBjdXJyZW50TG9jYXRpb24ueSkgPT0gLTEpIHtcbiAgICAgICAgcXVldWUucHVzaCh7eCA6IDEgKiBjdXJyZW50TG9jYXRpb24ueCArIDEsIHkgOiAxICogY3VycmVudExvY2F0aW9uLnl9KTtcbiAgICB9XG4gICAgaWYgKChtYXAuZ2V0VGlsZSgxICogY3VycmVudExvY2F0aW9uLngsIDEgKiBjdXJyZW50TG9jYXRpb24ueSAtIDEpICE9IDApICYmIGNoZWNrZWQuaW5kZXhPZigxICogY3VycmVudExvY2F0aW9uLnggKyAxMCAqICgxICogY3VycmVudExvY2F0aW9uLnkgLSAxKSkgPT0gLTEpIHtcbiAgICAgICAgcXVldWUucHVzaCh7eCA6IDEgKiBjdXJyZW50TG9jYXRpb24ueCwgeSA6IDEgKiBjdXJyZW50TG9jYXRpb24ueSAtIDF9KTtcbiAgICB9XG4gICAgaWYgKChtYXAuZ2V0VGlsZSgxICogY3VycmVudExvY2F0aW9uLngsIDEgKiBjdXJyZW50TG9jYXRpb24ueSArIDEpICE9IDApICYmIGNoZWNrZWQuaW5kZXhPZigxICogY3VycmVudExvY2F0aW9uLnggKyAxMCAqICgxICogY3VycmVudExvY2F0aW9uLnkgKyAxKSkgPT0gLTEpIHtcbiAgICAgICAgcXVldWUucHVzaCh7eCA6IDEgKiBjdXJyZW50TG9jYXRpb24ueCwgeSA6IDEgKiBjdXJyZW50TG9jYXRpb24ueSArIDF9KTtcbiAgICB9XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
