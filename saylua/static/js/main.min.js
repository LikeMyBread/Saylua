var _FormValidation=function(){function r(r){var t=0,a=r.currentTarget,n=a.querySelectorAll("input, textarea"),o=document.getElementById(a.getAttribute("data-error-id"));o&&(o.innerHTML="");for(var i=0;i<n.length;i++){var l=n[i].getAttribute("data-validators"),c=n[i].getAttribute("data-errors");if(c&&(c=JSON.parse(c)),l){removeClass(n[i],"error"),l=l.split(" ");for(var d=!0,s=0;d&&s<l.length;s++){var u=l[s].split(":"),v=u[0];if(!e[v])throw"Invalid validator type: "+v;var f=n[i].value;if("checkbox"==n[i].type&&(f=n[i].checked),u=[f].concat(u.slice(1)),!e[v].validator.apply(this,u)){addClass(n[i],"error");var m,h=capitalizeFirst(n[i].name);m=c&&v in c?c[v]:e[v].error.replace("<field>",h.replace(/[_-]/g," "));for(var p=1;p<u.length;p++)m=m.replace("<"+p+">",u[p]);t++,d=!1,o.innerHTML+='<p class="error">'+m+"</p>"}}}}return!(t>0)||(r.preventDefault(),!1)}var e={required:{error:"<field> is required. ",validator:function(r){return r}},not_empty:{error:"<field> cannot be only spaces. ",validator:function(r){return/\S/.test(r)}},min:{error:"<field> cannot be shorter than <1> characters. ",validator:function(r,e){return r.length>=e}},max:{error:"<field> cannot be longer than <1> characters. ",validator:function(r,e){return r.length<=e}},username_chars:{error:"<field> may only contain letters, numbers, or these special characters: _.+!*()- ",validator:function(r){var e=new RegExp("^[A-Za-z0-9_.+!*()-]+$");return e.test(r)}},no_repeated_underscores:{error:"<field> may not contain two underscores in a row. ",validator:function(r){return r.indexOf("__")<0}},match_password:{error:"Passwords must match. ",validator:function(r,e){return document.getElementById(e).value===r}},email:{error:"<field> must be a valid email. ",validator:function(r){return/\S+@\S+\.\S+/.test(r)}}};return function(){this.bind=function(e){for(var t=document.querySelectorAll(e),a=0;a<t.length;a++)t[a].addEventListener("submit",r)}}}(),FormValidation=new _FormValidation;
function fixNavbar(e){var t=document.getElementById("banner").offsetHeight,n=document.getElementById("sidebar-container");document.body.scrollTop>t||document.documentElement.scrollTop>t?(addClass(document.getElementById("navbar"),"fixed"),n&&addClass(n,"fixed")):(removeClass(document.getElementById("navbar"),"fixed"),n&&removeClass(n,"fixed"))}function initializeRightMenu(){function e(){for(var e=0;e<d.length;e++)removeClass(d[e],"active");swapClass(i,"shown","hidden"),document.body.removeEventListener("click",n,!1)}function t(e){for(var t=0;t<d.length;t++)d[t].getAttribute("data-section")==e?addClass(d[t],"active"):removeClass(d[t],"active");for(var t=0;t<o.length;t++)o[t].id==e?o[t].style.display="block":o[t].style.display="none";swapClass(i,"hidden","shown"),document.body.addEventListener("click",n)}function n(t){var n=t.target;a.contains(n)||i.contains(n)||e()}for(var a=document.getElementById("navigation-right"),i=document.getElementById("dropdown-right"),d=a.getElementsByClassName("block-link"),o=i.getElementsByClassName("menu"),s=0;s<d.length;s++)d[s].addEventListener("click",function(n){n.preventDefault();var a=n.currentTarget;hasClass(a,"active")?(e(),removeClass(a,"active")):t(a.getAttribute("data-section"))})}window.addEventListener("load",function(){window.addEventListener("scroll",fixNavbar),initializeRightMenu(),FormValidation.bind(".validated-form")});
!function(t){function e(){var t=document.createDocumentFragment();if(this.modal=document.createElement("div"),this.modal.className="modal "+this.settings.className,this.modal.style.minWidth=this.settings.minWidth+"px",this.modal.style.maxWidth=this.settings.maxWidth+"px",this.settings.hasCloseButton===!0&&(this.closeButton=document.createElement("button"),this.closeButton.className="modal-close modal-close-button",this.closeButton.innerHTML="Ã—",this.modal.appendChild(this.closeButton)),this.settings.hasOverlay===!0&&(this.overlay=document.createElement("div"),this.overlay.className="modal-overlay "+this.settings.className,t.appendChild(this.overlay)),null!==this.settings.title){var e=document.createElement("h2");e.className="modal-title",e.innerHTML=this.settings.title,this.modal.appendChild(e)}var i=document.createElement("div");i.className="modal-content",i.innerHTML=this.settings.content,this.modal.appendChild(i),t.appendChild(this.modal),document.body.appendChild(t)}function i(){this.closeButton&&this.closeButton.addEventListener("click",this.close.bind(this)),this.overlay&&this.overlay.addEventListener("click",this.close.bind(this))}function s(){var t=document.createElement("div");return t.style.WebkitTransition?"webkitTransitionEnd":t.style.OTransition?"oTransitionEnd":"transitionend"}function n(t){t.parentElement&&t.parentElement.removeChild(t)}t.Modal=function(t){this.modal=null,this.overlay=null,this.closeButton=null,this.settings={className:"zoom",hasCloseButton:!0,content:"",title:null,maxWidth:800,minWidth:200,hasOverlay:!0,isFixed:!0,linkSelector:null};var e=this;if(t&&"object"==typeof t)for(var i in this.settings)t.hasOwnProperty(i)&&(this.settings[i]=t[i]);var s=this.settings.content;if(s&&s.innerHTML&&(s=s.innerHTML,n(this.settings.content),this.settings.content=s),null!==this.settings.linkSelector)for(var l=document.querySelectorAll(this.settings.linkSelector),a=0;a<l.length;a++)l[a].addEventListener("click",function(t){t.preventDefault(),e.open()})},Modal.prototype.open=function(){e.call(this),i.call(this),window.getComputedStyle(this.modal).height,this.modal.className+=this.modal.offsetHeight>window.innerHeight?" modal-active modal-anchored":" modal-active",this.overlay&&(this.overlay.className+=" modal-active")},Modal.prototype.close=function(){var t=this;this.modal.className=this.modal.className.replace(" modal-active",""),this.modal.addEventListener(s(),function(){n(t.modal)}),this.overlay&&(this.overlay.className=this.overlay.className.replace(" modal-active",""),this.overlay.addEventListener(s(),function(){n(t.overlay)}))}}(window);
function hasClass(s,e){return s.classList?s.classList.contains(e):!!s.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function addClass(s,e){s.classList?s.classList.add(e):hasClass(s,e)||(s.className+=" "+e)}function removeClass(s,e){if(s.classList)s.classList.remove(e);else if(hasClass(s,e)){var a=new RegExp("(\\s|^)"+e+"(\\s|$)");s.className=s.className.replace(a," ")}}function swapClass(s,e,a){removeClass(s,e),addClass(s,a)}function capitalizeFirst(s){return s.charAt(0).toUpperCase()+s.slice(1)}function removeElement(s){s&&s.parentNode.removeChild(s)}function arrayRemove(s,e){for(var a=s.length;a--;)if(s[a]===e)return s.splice(a,1),!0;return!1}Array.prototype.includes||(Array.prototype.includes=function(s){"use strict";var e=Object(this),a=parseInt(e.length,10)||0;if(0===a)return!1;var r,t=parseInt(arguments[1],10)||0;t>=0?r=t:(r=a+t,r<0&&(r=0));for(var n;r<a;){if(n=e[r],s===n||s!==s&&n!==n)return!0;r++}return!1});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZvcm1WYWxpZGF0ZS5qcyIsIm1haW4uanMiLCJtb2RhbC5qcyIsInV0aWxzLmpzIl0sIm5hbWVzIjpbIl9Gb3JtVmFsaWRhdGlvbiIsIl9mb3JtU3VibWl0TGlzdGVuZXIiLCJlIiwiZXJyQ291bnQiLCJmb3JtIiwiY3VycmVudFRhcmdldCIsImZpZWxkcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlcnJvckNvbnRhaW5lciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRBdHRyaWJ1dGUiLCJpbm5lckhUTUwiLCJqIiwibGVuZ3RoIiwidmFsaWRhdG9ycyIsImVycm9ycyIsIkpTT04iLCJwYXJzZSIsInJlbW92ZUNsYXNzIiwic3BsaXQiLCJub0Vycm9ycyIsImsiLCJwYXJhbXMiLCJ2YWxpZGF0b3JOYW1lIiwidmFsaWRhdG9yTGlzdCIsInZhbHVlIiwidHlwZSIsImNoZWNrZWQiLCJjb25jYXQiLCJzbGljZSIsInZhbGlkYXRvciIsImFwcGx5IiwidGhpcyIsImFkZENsYXNzIiwiZXJyIiwiZmllbGQiLCJjYXBpdGFsaXplRmlyc3QiLCJuYW1lIiwiZXJyb3IiLCJyZXBsYWNlIiwibCIsInByZXZlbnREZWZhdWx0IiwicmVxdWlyZWQiLCJpbnB1dCIsIm5vdF9lbXB0eSIsInRlc3QiLCJtaW4iLCJtYXgiLCJ1c2VybmFtZV9jaGFycyIsInJlZyIsIlJlZ0V4cCIsIm5vX3JlcGVhdGVkX3VuZGVyc2NvcmVzIiwiaW5kZXhPZiIsIm1hdGNoX3Bhc3N3b3JkIiwibWF0Y2hfaWQiLCJlbWFpbCIsImJpbmQiLCJzZWxlY3RvciIsImZvcm1zIiwiaSIsImFkZEV2ZW50TGlzdGVuZXIiLCJGb3JtVmFsaWRhdGlvbiIsImZpeE5hdmJhciIsInRvcCIsIm9mZnNldEhlaWdodCIsInNpZGViYXJzIiwiYm9keSIsInNjcm9sbFRvcCIsImRvY3VtZW50RWxlbWVudCIsImluaXRpYWxpemVSaWdodE1lbnUiLCJoaWRlTWVudSIsImxpbmtzIiwic3dhcENsYXNzIiwibWVudSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjbG9zZU9uT3V0c2lkZUNsaWNrIiwic2hvd01lbnUiLCJzZWN0aW9uIiwic2VjdGlvbnMiLCJpZCIsInN0eWxlIiwiZGlzcGxheSIsInRhcmdldCIsIm5hdmlnYXRpb24iLCJjb250YWlucyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJsaW5rIiwiaGFzQ2xhc3MiLCJ3aW5kb3ciLCJnIiwiYnVpbGRNb2RhbCIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsIm1vZGFsIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInNldHRpbmdzIiwibWluV2lkdGgiLCJtYXhXaWR0aCIsImhhc0Nsb3NlQnV0dG9uIiwiY2xvc2VCdXR0b24iLCJhcHBlbmRDaGlsZCIsImhhc092ZXJsYXkiLCJvdmVybGF5IiwidGl0bGUiLCJjb250ZW50IiwiaW5pdGlhbGl6ZUV2ZW50cyIsImNsb3NlIiwidHJhbnNpdGlvbkVuZCIsImVsIiwiV2Via2l0VHJhbnNpdGlvbiIsIk9UcmFuc2l0aW9uIiwicmVtb3ZlRWxlbWVudCIsIm9iaiIsInBhcmVudEVsZW1lbnQiLCJyZW1vdmVDaGlsZCIsIk1vZGFsIiwibW9kYWxTZXR0aW5ncyIsImlzRml4ZWQiLCJsaW5rU2VsZWN0b3IiLCJzZWxmIiwia2V5IiwiaGFzT3duUHJvcGVydHkiLCJvcGVuIiwicHJvdG90eXBlIiwiY2FsbCIsImdldENvbXB1dGVkU3R5bGUiLCJoZWlnaHQiLCJpbm5lckhlaWdodCIsImNsYXNzTGlzdCIsIm1hdGNoIiwiYWRkIiwicmVtb3ZlIiwiY2xhc3NBIiwiY2xhc3NCIiwic3RyaW5nIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJwYXJlbnROb2RlIiwiYXJyYXlSZW1vdmUiLCJhcnIiLCJpdGVtIiwic3BsaWNlIiwiQXJyYXkiLCJpbmNsdWRlcyIsInNlYXJjaEVsZW1lbnQiLCJPIiwiT2JqZWN0IiwibGVuIiwicGFyc2VJbnQiLCJuIiwiYXJndW1lbnRzIiwiY3Vy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TyxDQUVsQ0QsSUFBSyxFQUNQakksRUFBSWlJLEdBRUpqSSxFQUFJK0gsRUFBTUUsRUFDTmpJLEVBQUksSUFBSUEsRUFBSSxHQUdsQixLQURBLEdBQUltSSxHQUNHbkksRUFBSStILEdBQUssQ0FFZCxHQURBSSxFQUFpQk4sRUFBRTdILEdBQ2Y0SCxJQUFrQk8sR0FDbEJQLElBQWtCQSxHQUFpQk8sSUFBbUJBLEVBQ3hELE9BQU8sQ0FFVG5JLEtBRUYsT0FBTyIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIERlcGVuZHMgb24gdXRpbHMuanNcbnZhciBfRm9ybVZhbGlkYXRpb24gPSAoZnVuY3Rpb24gRm9ybVZhbGlkYXRpb24oKSB7XG4gIHZhciB2YWxpZGF0b3JMaXN0ID0ge1xuICAgICdyZXF1aXJlZCc6IHtcbiAgICAgICdlcnJvcic6ICc8ZmllbGQ+IGlzIHJlcXVpcmVkLiAnLFxuICAgICAgJ3ZhbGlkYXRvcic6ICBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgICAgfVxuICAgIH0sXG4gICAgJ25vdF9lbXB0eSc6IHtcbiAgICAgICdlcnJvcic6ICc8ZmllbGQ+IGNhbm5vdCBiZSBvbmx5IHNwYWNlcy4gJyxcbiAgICAgICd2YWxpZGF0b3InOiAgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiAvXFxTLy50ZXN0KGlucHV0KTtcbiAgICAgIH1cbiAgICB9LFxuICAgICdtaW4nOiB7XG4gICAgICAnZXJyb3InOiAnPGZpZWxkPiBjYW5ub3QgYmUgc2hvcnRlciB0aGFuIDwxPiBjaGFyYWN0ZXJzLiAnLFxuICAgICAgJ3ZhbGlkYXRvcic6IGZ1bmN0aW9uIChpbnB1dCwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBpbnB1dC5sZW5ndGggPj0gbGVuZ3RoO1xuICAgICAgfVxuICAgIH0sXG4gICAgJ21heCc6IHtcbiAgICAgICdlcnJvcic6ICc8ZmllbGQ+IGNhbm5vdCBiZSBsb25nZXIgdGhhbiA8MT4gY2hhcmFjdGVycy4gJyxcbiAgICAgICd2YWxpZGF0b3InOiBmdW5jdGlvbiAoaW5wdXQsIGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gaW5wdXQubGVuZ3RoIDw9IGxlbmd0aDtcbiAgICAgIH1cbiAgICB9LFxuICAgICd1c2VybmFtZV9jaGFycyc6IHtcbiAgICAgICdlcnJvcic6ICc8ZmllbGQ+IG1heSBvbmx5IGNvbnRhaW4gbGV0dGVycywgbnVtYmVycywgb3IgdGhlc2Ugc3BlY2lhbCBjaGFyYWN0ZXJzOiBfLishKigpLSAnLFxuICAgICAgJ3ZhbGlkYXRvcic6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cCgnXltBLVphLXowLTlfLishKigpLV0rJCcpO1xuICAgICAgICByZXR1cm4gcmVnLnRlc3QoaW5wdXQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgJ25vX3JlcGVhdGVkX3VuZGVyc2NvcmVzJzoge1xuICAgICAgJ2Vycm9yJzogJzxmaWVsZD4gbWF5IG5vdCBjb250YWluIHR3byB1bmRlcnNjb3JlcyBpbiBhIHJvdy4gJyxcbiAgICAgICd2YWxpZGF0b3InOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0LmluZGV4T2YoJ19fJykgPCAwO1xuICAgICAgfVxuICAgIH0sXG4gICAgJ21hdGNoX3Bhc3N3b3JkJzoge1xuICAgICAgJ2Vycm9yJzogJ1Bhc3N3b3JkcyBtdXN0IG1hdGNoLiAnLFxuICAgICAgJ3ZhbGlkYXRvcic6IGZ1bmN0aW9uIChpbnB1dCwgbWF0Y2hfaWQpIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG1hdGNoX2lkKS52YWx1ZSA9PT0gaW5wdXQ7XG4gICAgICB9XG4gICAgfSxcbiAgICAnZW1haWwnOiB7XG4gICAgICAnZXJyb3InOiAnPGZpZWxkPiBtdXN0IGJlIGEgdmFsaWQgZW1haWwuICcsXG4gICAgICAndmFsaWRhdG9yJzogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiAvXFxTK0BcXFMrXFwuXFxTKy8udGVzdChpbnB1dCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBmdW5jdGlvbiBGb3JtVmFsaWRhdGlvbkNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYmluZCA9IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICB2YXIgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZm9ybXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9ybXNbaV0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgX2Zvcm1TdWJtaXRMaXN0ZW5lcik7IC8vIEVuZCBldmVudCBsaXN0ZW5lclxuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgZnVuY3Rpb24gX2Zvcm1TdWJtaXRMaXN0ZW5lcihlKSB7XG4gICAgdmFyIGVyckNvdW50ID0gMDtcbiAgICB2YXIgZm9ybSA9IGUuY3VycmVudFRhcmdldDtcbiAgICB2YXIgZmllbGRzID0gZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCwgdGV4dGFyZWEnKTtcbiAgICB2YXIgZXJyb3JDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmb3JtLmdldEF0dHJpYnV0ZSgnZGF0YS1lcnJvci1pZCcpKTtcbiAgICBpZiAoZXJyb3JDb250YWluZXIpIHtcbiAgICAgIGVycm9yQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xuICAgIH1cbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZpZWxkcy5sZW5ndGg7IGorKykge1xuICAgICAgdmFyIHZhbGlkYXRvcnMgPSBmaWVsZHNbal0uZ2V0QXR0cmlidXRlKCdkYXRhLXZhbGlkYXRvcnMnKTtcbiAgICAgIHZhciBlcnJvcnMgPSBmaWVsZHNbal0uZ2V0QXR0cmlidXRlKCdkYXRhLWVycm9ycycpO1xuICAgICAgaWYgKGVycm9ycykge1xuICAgICAgICBlcnJvcnMgPSBKU09OLnBhcnNlKGVycm9ycyk7XG4gICAgICB9XG4gICAgICBpZiAodmFsaWRhdG9ycykge1xuICAgICAgICByZW1vdmVDbGFzcyhmaWVsZHNbal0sICdlcnJvcicpO1xuICAgICAgICB2YWxpZGF0b3JzID0gdmFsaWRhdG9ycy5zcGxpdChcIiBcIik7XG4gICAgICAgIHZhciBub0Vycm9ycyA9IHRydWU7XG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBub0Vycm9ycyAmJiBrIDwgdmFsaWRhdG9ycy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgIHZhciBwYXJhbXMgPSB2YWxpZGF0b3JzW2tdLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgICB2YXIgdmFsaWRhdG9yTmFtZSA9IHBhcmFtc1swXTtcbiAgICAgICAgICBpZighdmFsaWRhdG9yTGlzdFt2YWxpZGF0b3JOYW1lXSkge1xuICAgICAgICAgICAgdGhyb3cgXCJJbnZhbGlkIHZhbGlkYXRvciB0eXBlOiBcIiArIHZhbGlkYXRvck5hbWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHZhbHVlID0gZmllbGRzW2pdLnZhbHVlO1xuICAgICAgICAgIGlmIChmaWVsZHNbal0udHlwZSA9PSAnY2hlY2tib3gnKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IGZpZWxkc1tqXS5jaGVja2VkO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFtpbnB1dCwgcDEsIHAyLCAuLi5dXG4gICAgICAgICAgcGFyYW1zID0gW3ZhbHVlXS5jb25jYXQocGFyYW1zLnNsaWNlKDEpKTtcblxuICAgICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgdmFsaWRhdGlvbiBmYWlsc1xuICAgICAgICAgIGlmICghdmFsaWRhdG9yTGlzdFt2YWxpZGF0b3JOYW1lXS52YWxpZGF0b3IuYXBwbHkodGhpcywgcGFyYW1zKSkge1xuICAgICAgICAgICAgYWRkQ2xhc3MoZmllbGRzW2pdLCAnZXJyb3InKTtcbiAgICAgICAgICAgIHZhciBmaWVsZCA9IGNhcGl0YWxpemVGaXJzdChmaWVsZHNbal0ubmFtZSk7XG4gICAgICAgICAgICB2YXIgZXJyO1xuICAgICAgICAgICAgaWYgKGVycm9ycyAmJiB2YWxpZGF0b3JOYW1lIGluIGVycm9ycykge1xuICAgICAgICAgICAgICBlcnIgPSBlcnJvcnNbdmFsaWRhdG9yTmFtZV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlcnIgPSB2YWxpZGF0b3JMaXN0W3ZhbGlkYXRvck5hbWVdLmVycm9yLnJlcGxhY2UoJzxmaWVsZD4nLCBmaWVsZC5yZXBsYWNlKC9bXy1dL2csICcgJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgbCA9IDE7IGwgPCBwYXJhbXMubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgICAgICAgZXJyID0gZXJyLnJlcGxhY2UoJzwnICsgbCArICc+JywgcGFyYW1zW2xdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVyckNvdW50Kys7XG4gICAgICAgICAgICBub0Vycm9ycyA9IGZhbHNlO1xuICAgICAgICAgICAgZXJyb3JDb250YWluZXIuaW5uZXJIVE1MICs9ICc8cCBjbGFzcz1cImVycm9yXCI+JyArIGVyciArICc8L3A+JztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVyckNvdW50ID4gMCkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufSgpKTtcblxudmFyIEZvcm1WYWxpZGF0aW9uID0gbmV3IF9Gb3JtVmFsaWRhdGlvbigpO1xuIiwid2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmaXhOYXZiYXIpO1xuXG4gIC8vIEdldCBhbGwgb2YgdGhlIHJpZ2h0IG5hdmJhciBsaW5rcyBhbmQgYmluZCBjbGljayBldmVudHMgdG8gdGhlbVxuICBpbml0aWFsaXplUmlnaHRNZW51KCk7XG5cbiAgLy8gRm9ybSBWYWxpZGF0aW9uXG4gIEZvcm1WYWxpZGF0aW9uLmJpbmQoJy52YWxpZGF0ZWQtZm9ybScpO1xufSk7XG5cbi8vIE1ha2UgbmF2aWdhdGlvbiBiYXIgc3RheSBhdCB0aGUgdG9wXG5mdW5jdGlvbiBmaXhOYXZiYXIoZSkge1xuICB2YXIgdG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYW5uZXJcIikub2Zmc2V0SGVpZ2h0O1xuICB2YXIgc2lkZWJhcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNpZGViYXItY29udGFpbmVyXCIpO1xuICBpZiAoZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPiB0b3AgfHxcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID4gdG9wKSB7XG4gICAgYWRkQ2xhc3MoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYXZiYXJcIiksIFwiZml4ZWRcIik7XG4gICAgaWYgKHNpZGViYXJzKSB7XG4gICAgICBhZGRDbGFzcyhzaWRlYmFycywgXCJmaXhlZFwiKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmVtb3ZlQ2xhc3MoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYXZiYXJcIiksIFwiZml4ZWRcIik7XG4gICAgaWYgKHNpZGViYXJzKSB7XG4gICAgICByZW1vdmVDbGFzcyhzaWRlYmFycywgXCJmaXhlZFwiKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdGlhbGl6ZVJpZ2h0TWVudSgpIHtcbiAgdmFyIG5hdmlnYXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmF2aWdhdGlvbi1yaWdodCcpO1xuICB2YXIgbWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wZG93bi1yaWdodCcpO1xuICB2YXIgbGlua3MgPSBuYXZpZ2F0aW9uLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Jsb2NrLWxpbmsnKTtcbiAgdmFyIHNlY3Rpb25zID0gbWVudS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtZW51Jyk7XG5cbiAgLy8gRm9yIHRocm91Z2ggcmlnaHQgbmF2aWdhdGlvbiBsaW5rcyBhbmQgYXR0YWNoIGxpc3RlbmVycyB0byB0aGVtXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcbiAgICBsaW5rc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIGNoYW5nZVJpZ2h0TWVudShlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB2YXIgbGluayA9IGUuY3VycmVudFRhcmdldDtcblxuICAgICAgaWYgKGhhc0NsYXNzKGxpbmssICdhY3RpdmUnKSkge1xuICAgICAgICAvLyBDbGlja2luZyBvbiBhIHNlbGVjdGVkIGljb24gcmVtb3ZlcyB0aGUgbWVudVxuICAgICAgICBoaWRlTWVudSgpO1xuICAgICAgICByZW1vdmVDbGFzcyhsaW5rLCAnYWN0aXZlJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzaG93TWVudShsaW5rLmdldEF0dHJpYnV0ZSgnZGF0YS1zZWN0aW9uJykpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gaGlkZU1lbnUoKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykge1xuICAgICAgcmVtb3ZlQ2xhc3MobGlua3NbaV0sICdhY3RpdmUnKTtcbiAgICB9XG4gICAgc3dhcENsYXNzKG1lbnUsICdzaG93bicsICdoaWRkZW4nKTtcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VPbk91dHNpZGVDbGljaywgZmFsc2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd01lbnUoc2VjdGlvbikge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChsaW5rc1tpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2VjdGlvbicpID09IHNlY3Rpb24pIHtcbiAgICAgICAgYWRkQ2xhc3MobGlua3NbaV0sICdhY3RpdmUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKGxpbmtzW2ldLCAnYWN0aXZlJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzZWN0aW9uc1tpXS5pZCA9PSBzZWN0aW9uKSB7XG4gICAgICAgIHNlY3Rpb25zW2ldLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VjdGlvbnNbaV0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgIH1cbiAgICB9XG4gICAgc3dhcENsYXNzKG1lbnUsICdoaWRkZW4nLCAnc2hvd24nKTtcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VPbk91dHNpZGVDbGljayk7XG4gIH1cblxuICBmdW5jdGlvbiBjbG9zZU9uT3V0c2lkZUNsaWNrIChlKSB7XG4gICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIGlmICghbmF2aWdhdGlvbi5jb250YWlucyh0YXJnZXQpICYmICFtZW51LmNvbnRhaW5zKHRhcmdldCkpIHtcbiAgICAgIGhpZGVNZW51KCk7XG4gICAgfVxuICB9XG59XG4iLCIvKlxuICogQSBzaW1wbHkgbGlicmFyeSBmb3IgYSBKYXZhU2NyaXB0IG1vZGFsIHdpdGggbm8gZGVwZW5kZW5jaWVzLlxuICovXG4oZnVuY3Rpb24gKGcpIHtcbiAgZy5Nb2RhbCA9IGZ1bmN0aW9uIChtb2RhbFNldHRpbmdzKSB7XG4gICAgLy8gQSByZWZlcmVuY2UgdG8gdGhlIG1vZGFsIHBpZWNlcyBpbiB0aGUgZG9tXG4gICAgdGhpcy5tb2RhbCA9IG51bGw7XG4gICAgdGhpcy5vdmVybGF5ID0gbnVsbDtcbiAgICB0aGlzLmNsb3NlQnV0dG9uID0gbnVsbDtcblxuICAgIC8vIEluaXRpYWxpemVkIHRvIGFsbCBvZiB0aGUgZGVmYXVsdHMgZm9yIHRoaXMgdGhpbmchXG4gICAgdGhpcy5zZXR0aW5ncyA9IHtcbiAgICAgIGNsYXNzTmFtZTogXCJ6b29tXCIsXG4gICAgICBoYXNDbG9zZUJ1dHRvbjogdHJ1ZSxcbiAgICAgIGNvbnRlbnQ6IFwiXCIsXG4gICAgICB0aXRsZTogbnVsbCxcbiAgICAgIG1heFdpZHRoOiA4MDAsXG4gICAgICBtaW5XaWR0aDogMjAwLFxuICAgICAgaGFzT3ZlcmxheTogdHJ1ZSxcbiAgICAgIGlzRml4ZWQ6IHRydWUsXG4gICAgICBsaW5rU2VsZWN0b3I6IG51bGxcbiAgICB9O1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgaWYgKG1vZGFsU2V0dGluZ3MgJiYgdHlwZW9mIG1vZGFsU2V0dGluZ3MgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLnNldHRpbmdzKSB7XG4gICAgICAgIGlmIChtb2RhbFNldHRpbmdzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICB0aGlzLnNldHRpbmdzW2tleV0gPSBtb2RhbFNldHRpbmdzW2tleV1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBjb250ZW50ID0gdGhpcy5zZXR0aW5ncy5jb250ZW50O1xuICAgIGlmIChjb250ZW50ICYmIGNvbnRlbnQuaW5uZXJIVE1MKSB7XG4gICAgICBjb250ZW50ID0gY29udGVudC5pbm5lckhUTUw7XG4gICAgICByZW1vdmVFbGVtZW50KHRoaXMuc2V0dGluZ3MuY29udGVudCk7XG4gICAgICB0aGlzLnNldHRpbmdzLmNvbnRlbnQgPSBjb250ZW50O1xuICAgIH1cblxuICAgIGlmICh0aGlzLnNldHRpbmdzLmxpbmtTZWxlY3RvciAhPT0gbnVsbCkge1xuICAgICAgdmFyIGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNldHRpbmdzLmxpbmtTZWxlY3Rvcik7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGlua3NbaV0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHNlbGYub3BlbigpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgYnVpbGRNb2RhbC5jYWxsKHRoaXMpO1xuICAgIGluaXRpYWxpemVFdmVudHMuY2FsbCh0aGlzKTtcblxuICAgIC8vIEZvciBhbmltYXRpb25zXG4gICAgd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5tb2RhbCkuaGVpZ2h0O1xuXG4gICAgdGhpcy5tb2RhbC5jbGFzc05hbWUgKz0gdGhpcy5tb2RhbC5vZmZzZXRIZWlnaHQgPiB3aW5kb3cuaW5uZXJIZWlnaHQgP1xuICAgICAgXCIgbW9kYWwtYWN0aXZlIG1vZGFsLWFuY2hvcmVkXCIgOiBcIiBtb2RhbC1hY3RpdmVcIjtcbiAgICBpZiAodGhpcy5vdmVybGF5KSB7XG4gICAgICB0aGlzLm92ZXJsYXkuY2xhc3NOYW1lICs9IFwiIG1vZGFsLWFjdGl2ZVwiO1xuICAgIH1cbiAgfTtcblxuICBNb2RhbC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5tb2RhbC5jbGFzc05hbWUgPSB0aGlzLm1vZGFsLmNsYXNzTmFtZS5yZXBsYWNlKFwiIG1vZGFsLWFjdGl2ZVwiLCBcIlwiKTtcblxuICAgIHRoaXMubW9kYWwuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kKCksIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJlbW92ZUVsZW1lbnQoc2VsZi5tb2RhbCk7XG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5vdmVybGF5KSB7XG4gICAgICB0aGlzLm92ZXJsYXkuY2xhc3NOYW1lID0gdGhpcy5vdmVybGF5LmNsYXNzTmFtZS5yZXBsYWNlKFwiIG1vZGFsLWFjdGl2ZVwiLCBcIlwiKTtcblxuICAgICAgdGhpcy5vdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkVuZCgpLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlbW92ZUVsZW1lbnQoc2VsZi5vdmVybGF5KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGJ1aWxkTW9kYWwgKCkge1xuICAgIHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICB0aGlzLm1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0aGlzLm1vZGFsLmNsYXNzTmFtZSA9IFwibW9kYWwgXCIgKyB0aGlzLnNldHRpbmdzLmNsYXNzTmFtZTtcbiAgICB0aGlzLm1vZGFsLnN0eWxlLm1pbldpZHRoID0gdGhpcy5zZXR0aW5ncy5taW5XaWR0aCArIFwicHhcIjtcbiAgICB0aGlzLm1vZGFsLnN0eWxlLm1heFdpZHRoID0gdGhpcy5zZXR0aW5ncy5tYXhXaWR0aCArIFwicHhcIjtcblxuICAgIGlmICh0aGlzLnNldHRpbmdzLmhhc0Nsb3NlQnV0dG9uID09PSB0cnVlKSB7XG4gICAgICB0aGlzLmNsb3NlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgIHRoaXMuY2xvc2VCdXR0b24uY2xhc3NOYW1lID0gXCJtb2RhbC1jbG9zZSBtb2RhbC1jbG9zZS1idXR0b25cIjtcbiAgICAgIHRoaXMuY2xvc2VCdXR0b24uaW5uZXJIVE1MID0gXCLDl1wiO1xuICAgICAgdGhpcy5tb2RhbC5hcHBlbmRDaGlsZCh0aGlzLmNsb3NlQnV0dG9uKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zZXR0aW5ncy5oYXNPdmVybGF5ID09PSB0cnVlKSB7XG4gICAgICB0aGlzLm92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgdGhpcy5vdmVybGF5LmNsYXNzTmFtZSA9IFwibW9kYWwtb3ZlcmxheSBcIiArIHRoaXMuc2V0dGluZ3MuY2xhc3NOYW1lO1xuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodGhpcy5vdmVybGF5KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zZXR0aW5ncy50aXRsZSAhPT0gbnVsbCkge1xuICAgICAgdmFyIHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgyXCIpO1xuICAgICAgdGl0bGUuY2xhc3NOYW1lID0gXCJtb2RhbC10aXRsZVwiO1xuICAgICAgdGl0bGUuaW5uZXJIVE1MID0gdGhpcy5zZXR0aW5ncy50aXRsZTtcbiAgICAgIHRoaXMubW9kYWwuYXBwZW5kQ2hpbGQodGl0bGUpO1xuICAgIH1cblxuICAgIHZhciBjb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjb250ZW50LmNsYXNzTmFtZSA9IFwibW9kYWwtY29udGVudFwiO1xuICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gdGhpcy5zZXR0aW5ncy5jb250ZW50O1xuICAgIHRoaXMubW9kYWwuYXBwZW5kQ2hpbGQoY29udGVudCk7XG5cbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0aGlzLm1vZGFsKTtcblxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICB9XG5cbiAgZnVuY3Rpb24gaW5pdGlhbGl6ZUV2ZW50cygpIHtcbiAgICBpZiAodGhpcy5jbG9zZUJ1dHRvbikge1xuICAgICAgdGhpcy5jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2UuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3ZlcmxheSkge1xuICAgICAgdGhpcy5vdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZS5iaW5kKHRoaXMpKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiB0cmFuc2l0aW9uRW5kKCkge1xuICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgaWYgKGVsLnN0eWxlLldlYmtpdFRyYW5zaXRpb24pIHJldHVybiBcIndlYmtpdFRyYW5zaXRpb25FbmRcIjtcbiAgICBpZiAoZWwuc3R5bGUuT1RyYW5zaXRpb24pIHJldHVybiBcIm9UcmFuc2l0aW9uRW5kXCI7XG4gICAgcmV0dXJuICd0cmFuc2l0aW9uZW5kJztcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQgKG9iaikge1xuICAgIGlmIChvYmoucGFyZW50RWxlbWVudCkge1xuICAgICAgb2JqLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQob2JqKTtcbiAgICB9XG4gIH1cbn0od2luZG93KSk7XG4iLCIvLyBodHRwOi8vamFrZXRyZW50LmNvbS9wb3N0L2FkZHJlbW92ZS1jbGFzc2VzLXJhdy1qYXZhc2NyaXB0L1xuZnVuY3Rpb24gaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkge1xuICBpZiAoZWwuY2xhc3NMaXN0KVxuICAgIHJldHVybiBlbC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKVxuICBlbHNlXG4gICAgcmV0dXJuICEhZWwuY2xhc3NOYW1lLm1hdGNoKG5ldyBSZWdFeHAoJyhcXFxcc3xeKScgKyBjbGFzc05hbWUgKyAnKFxcXFxzfCQpJykpXG59XG5cbmZ1bmN0aW9uIGFkZENsYXNzKGVsLCBjbGFzc05hbWUpIHtcbiAgaWYgKGVsLmNsYXNzTGlzdClcbiAgICBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSlcbiAgZWxzZSBpZiAoIWhhc0NsYXNzKGVsLCBjbGFzc05hbWUpKSBlbC5jbGFzc05hbWUgKz0gXCIgXCIgKyBjbGFzc05hbWVcbn1cblxuZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWwsIGNsYXNzTmFtZSkge1xuICBpZiAoZWwuY2xhc3NMaXN0KVxuICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKVxuICBlbHNlIGlmIChoYXNDbGFzcyhlbCwgY2xhc3NOYW1lKSkge1xuICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKCcoXFxcXHN8XiknICsgY2xhc3NOYW1lICsgJyhcXFxcc3wkKScpXG4gICAgZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lLnJlcGxhY2UocmVnLCAnICcpXG4gIH1cbn1cblxuZnVuY3Rpb24gc3dhcENsYXNzKGVsLCBjbGFzc0EsIGNsYXNzQikge1xuICByZW1vdmVDbGFzcyhlbCwgY2xhc3NBKTtcbiAgYWRkQ2xhc3MoZWwsIGNsYXNzQik7XG59XG5cbi8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTAyNjA2OS9jYXBpdGFsaXplLXRoZS1maXJzdC1sZXR0ZXItb2Ytc3RyaW5nLWluLWphdmFzY3JpcHRcbmZ1bmN0aW9uIGNhcGl0YWxpemVGaXJzdChzdHJpbmcpIHtcbiAgICByZXR1cm4gc3RyaW5nLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyaW5nLnNsaWNlKDEpO1xufVxuXG4vLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzg4MzA4MzkvamF2YXNjcmlwdC1kb20tcmVtb3ZlLWVsZW1lbnRcbmZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQoZWwpIHtcbiAgaWYgKGVsKSB7XG4gICAgZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbCk7XG4gIH1cbn1cblxuLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy81NzY3MzI1L2hvdy10by1yZW1vdmUtYS1wYXJ0aWN1bGFyLWVsZW1lbnQtZnJvbS1hbi1hcnJheS1pbi1qYXZhc2NyaXB0XG5mdW5jdGlvbiBhcnJheVJlbW92ZShhcnIsIGl0ZW0pIHtcbiAgICBmb3IodmFyIGkgPSBhcnIubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgIGlmKGFycltpXSA9PT0gaXRlbSkge1xuICAgICAgICAgICAgYXJyLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvaW5jbHVkZXMjUG9seWZpbGxcbmlmICghQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7XG4gIEFycmF5LnByb3RvdHlwZS5pbmNsdWRlcyA9IGZ1bmN0aW9uKHNlYXJjaEVsZW1lbnQgLyosIGZyb21JbmRleCovICkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgTyA9IE9iamVjdCh0aGlzKTtcbiAgICB2YXIgbGVuID0gcGFyc2VJbnQoTy5sZW5ndGgsIDEwKSB8fCAwO1xuICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIG4gPSBwYXJzZUludChhcmd1bWVudHNbMV0sIDEwKSB8fCAwO1xuICAgIHZhciBrO1xuICAgIGlmIChuID49IDApIHtcbiAgICAgIGsgPSBuO1xuICAgIH0gZWxzZSB7XG4gICAgICBrID0gbGVuICsgbjtcbiAgICAgIGlmIChrIDwgMCkge2sgPSAwO31cbiAgICB9XG4gICAgdmFyIGN1cnJlbnRFbGVtZW50O1xuICAgIHdoaWxlIChrIDwgbGVuKSB7XG4gICAgICBjdXJyZW50RWxlbWVudCA9IE9ba107XG4gICAgICBpZiAoc2VhcmNoRWxlbWVudCA9PT0gY3VycmVudEVsZW1lbnQgfHxcbiAgICAgICAgIChzZWFyY2hFbGVtZW50ICE9PSBzZWFyY2hFbGVtZW50ICYmIGN1cnJlbnRFbGVtZW50ICE9PSBjdXJyZW50RWxlbWVudCkpIHsgLy8gTmFOICE9PSBOYU5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBrKys7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
