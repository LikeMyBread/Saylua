var _FormValidation=function(){function r(r){var t=0,a=r.currentTarget,n=a.querySelectorAll("input, textarea"),o=document.getElementById(a.getAttribute("data-error-id"));o&&(o.innerHTML="");for(var i=0;i<n.length;i++){var l=n[i].getAttribute("data-validators"),c=n[i].getAttribute("data-errors");if(c&&(c=JSON.parse(c)),l){removeClass(n[i],"error"),l=l.split(" ");for(var d=!0,s=0;d&&s<l.length;s++){var u=l[s].split(":"),v=u[0];if(!e[v])throw"Invalid validator type: "+v;var f=n[i].value;if("checkbox"==n[i].type&&(f=n[i].checked),u=[f].concat(u.slice(1)),!e[v].validator.apply(this,u)){addClass(n[i],"error");var m,h=capitalizeFirst(n[i].name);m=c&&v in c?c[v]:e[v].error.replace("<field>",h.replace(/[_-]/g," "));for(var p=1;p<u.length;p++)m=m.replace("<"+p+">",u[p]);t++,d=!1,o.innerHTML+='<p class="error">'+m+"</p>"}}}}return!(t>0)||(r.preventDefault(),!1)}var e={required:{error:"<field> is required. ",validator:function(r){return r}},not_empty:{error:"<field> cannot be only spaces. ",validator:function(r){return/\S/.test(r)}},min:{error:"<field> cannot be shorter than <1> characters. ",validator:function(r,e){return r.length>=e}},max:{error:"<field> cannot be longer than <1> characters. ",validator:function(r,e){return r.length<=e}},username_chars:{error:"<field> may only contain letters, numbers, or these special characters: _.+!*()- ",validator:function(r){var e=new RegExp("^[A-Za-z0-9_.+!*()-]+$");return e.test(r)}},no_repeated_underscores:{error:"<field> may not contain two underscores in a row. ",validator:function(r){return r.indexOf("__")<0}},match_password:{error:"Passwords must match. ",validator:function(r,e){return document.getElementById(e).value===r}},email:{error:"<field> must be a valid email. ",validator:function(r){return/\S+@\S+\.\S+/.test(r)}}};return function(){this.bind=function(e){for(var t=document.querySelectorAll(e),a=0;a<t.length;a++)t[a].addEventListener("submit",r)}}}(),FormValidation=new _FormValidation;
function fixNavbar(e){var t=document.getElementById("banner").offsetHeight,n=document.getElementById("sidebar-container");document.body.scrollTop>t||document.documentElement.scrollTop>t?(addClass(document.getElementById("navbar"),"fixed"),n&&addClass(n,"fixed")):(removeClass(document.getElementById("navbar"),"fixed"),n&&removeClass(n,"fixed"))}function initializeRightMenu(){function e(){for(var e=0;e<d.length;e++)removeClass(d[e],"active");swapClass(i,"shown","hidden"),document.body.removeEventListener("click",n,!1)}function t(e){for(var t=0;t<d.length;t++)d[t].getAttribute("data-section")==e?addClass(d[t],"active"):removeClass(d[t],"active");for(var t=0;t<o.length;t++)o[t].id==e?o[t].style.display="block":o[t].style.display="none";swapClass(i,"hidden","shown"),document.body.addEventListener("click",n)}function n(t){var n=t.target;a.contains(n)||i.contains(n)||e()}for(var a=document.getElementById("navigation-right"),i=document.getElementById("dropdown-right"),d=a.getElementsByClassName("block-link"),o=i.getElementsByClassName("menu"),s=0;s<d.length;s++)d[s].addEventListener("click",function(n){n.preventDefault();var a=n.currentTarget;hasClass(a,"active")?(e(),removeClass(a,"active")):t(a.getAttribute("data-section"))})}window.addEventListener("load",function(){window.addEventListener("scroll",fixNavbar),initializeRightMenu(),FormValidation.bind(".validated-form")});
!function(t){function e(){var t=document.createDocumentFragment();if(this.modal=document.createElement("div"),this.modal.className="modal "+this.settings.className,this.modal.style.minWidth=this.settings.minWidth+"px",this.modal.style.maxWidth=this.settings.maxWidth+"px",this.settings.hasCloseButton===!0&&(this.closeButton=document.createElement("button"),this.closeButton.className="modal-close modal-close-button",this.closeButton.innerHTML="Ã—",this.modal.appendChild(this.closeButton)),this.settings.hasOverlay===!0&&(this.overlay=document.createElement("div"),this.overlay.className="modal-overlay "+this.settings.className,t.appendChild(this.overlay)),null!==this.settings.title){var e=document.createElement("h2");e.className="modal-title",e.innerHTML=this.settings.title,this.modal.appendChild(e)}var i=document.createElement("div");i.className="modal-content",i.innerHTML=this.settings.content,this.modal.appendChild(i),t.appendChild(this.modal),document.body.appendChild(t)}function i(){this.closeButton&&this.closeButton.addEventListener("click",this.close.bind(this)),this.overlay&&this.overlay.addEventListener("click",this.close.bind(this))}function s(){var t=document.createElement("div");return t.style.WebkitTransition?"webkitTransitionEnd":t.style.OTransition?"oTransitionEnd":"transitionend"}function n(t){t.parentElement&&t.parentElement.removeChild(t)}t.Modal=function(t){this.modal=null,this.overlay=null,this.closeButton=null,this.settings={className:"zoom",hasCloseButton:!0,content:"",title:null,maxWidth:800,minWidth:200,hasOverlay:!0,isFixed:!0,linkSelector:null};var e=this;if(t&&"object"==typeof t)for(var i in this.settings)t.hasOwnProperty(i)&&(this.settings[i]=t[i]);var s=this.settings.content;if(s&&s.innerHTML&&(s=s.innerHTML,n(this.settings.content),this.settings.content=s),null!==this.settings.linkSelector)for(var l=document.querySelectorAll(this.settings.linkSelector),a=0;a<l.length;a++)l[a].addEventListener("click",function(t){t.preventDefault(),e.open()})},Modal.prototype.open=function(){e.call(this),i.call(this),window.getComputedStyle(this.modal).height,this.modal.className+=this.modal.offsetHeight>window.innerHeight?" modal-active modal-anchored":" modal-active",this.overlay&&(this.overlay.className+=" modal-active")},Modal.prototype.close=function(){var t=this;this.modal.className=this.modal.className.replace(" modal-active",""),this.modal.addEventListener(s(),function(){n(t.modal)}),this.overlay&&(this.overlay.className=this.overlay.className.replace(" modal-active",""),this.overlay.addEventListener(s(),function(){n(t.overlay)}))}}(window);
function hasClass(s,a){return s.classList?s.classList.contains(a):!!s.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))}function addClass(s,a){s.classList?s.classList.add(a):hasClass(s,a)||(s.className+=" "+a)}function removeClass(s,a){if(s.classList)s.classList.remove(a);else if(hasClass(s,a)){var e=new RegExp("(\\s|^)"+a+"(\\s|$)");s.className=s.className.replace(e," ")}}function swapClass(s,a,e){removeClass(s,a),addClass(s,e)}function capitalizeFirst(s){return s.charAt(0).toUpperCase()+s.slice(1)}function removeElement(s){s&&s.parentNode.removeChild(s)}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZvcm1WYWxpZGF0ZS5qcyIsIm1haW4uanMiLCJtb2RhbC5qcyIsInV0aWxzLmpzIl0sIm5hbWVzIjpbIl9Gb3JtVmFsaWRhdGlvbiIsIl9mb3JtU3VibWl0TGlzdGVuZXIiLCJlIiwiZXJyQ291bnQiLCJmb3JtIiwiY3VycmVudFRhcmdldCIsImZpZWxkcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlcnJvckNvbnRhaW5lciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRBdHRyaWJ1dGUiLCJpbm5lckhUTUwiLCJqIiwibGVuZ3RoIiwidmFsaWRhdG9ycyIsImVycm9ycyIsIkpTT04iLCJwYXJzZSIsInJlbW92ZUNsYXNzIiwic3BsaXQiLCJub0Vycm9ycyIsImsiLCJwYXJhbXMiLCJ2YWxpZGF0b3JOYW1lIiwidmFsaWRhdG9yTGlzdCIsInZhbHVlIiwidHlwZSIsImNoZWNrZWQiLCJjb25jYXQiLCJzbGljZSIsInZhbGlkYXRvciIsImFwcGx5IiwidGhpcyIsImFkZENsYXNzIiwiZXJyIiwiZmllbGQiLCJjYXBpdGFsaXplRmlyc3QiLCJuYW1lIiwiZXJyb3IiLCJyZXBsYWNlIiwibCIsInByZXZlbnREZWZhdWx0IiwicmVxdWlyZWQiLCJpbnB1dCIsIm5vdF9lbXB0eSIsInRlc3QiLCJtaW4iLCJtYXgiLCJ1c2VybmFtZV9jaGFycyIsInJlZyIsIlJlZ0V4cCIsIm5vX3JlcGVhdGVkX3VuZGVyc2NvcmVzIiwiaW5kZXhPZiIsIm1hdGNoX3Bhc3N3b3JkIiwibWF0Y2hfaWQiLCJlbWFpbCIsImJpbmQiLCJzZWxlY3RvciIsImZvcm1zIiwiaSIsImFkZEV2ZW50TGlzdGVuZXIiLCJGb3JtVmFsaWRhdGlvbiIsImZpeE5hdmJhciIsInRvcCIsIm9mZnNldEhlaWdodCIsInNpZGViYXJzIiwiYm9keSIsInNjcm9sbFRvcCIsImRvY3VtZW50RWxlbWVudCIsImluaXRpYWxpemVSaWdodE1lbnUiLCJoaWRlTWVudSIsImxpbmtzIiwic3dhcENsYXNzIiwibWVudSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjbG9zZU9uT3V0c2lkZUNsaWNrIiwic2hvd01lbnUiLCJzZWN0aW9uIiwic2VjdGlvbnMiLCJpZCIsInN0eWxlIiwiZGlzcGxheSIsInRhcmdldCIsIm5hdmlnYXRpb24iLCJjb250YWlucyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJsaW5rIiwiaGFzQ2xhc3MiLCJ3aW5kb3ciLCJnIiwiYnVpbGRNb2RhbCIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsIm1vZGFsIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInNldHRpbmdzIiwibWluV2lkdGgiLCJtYXhXaWR0aCIsImhhc0Nsb3NlQnV0dG9uIiwiY2xvc2VCdXR0b24iLCJhcHBlbmRDaGlsZCIsImhhc092ZXJsYXkiLCJvdmVybGF5IiwidGl0bGUiLCJjb250ZW50IiwiaW5pdGlhbGl6ZUV2ZW50cyIsImNsb3NlIiwidHJhbnNpdGlvbkVuZCIsImVsIiwiV2Via2l0VHJhbnNpdGlvbiIsIk9UcmFuc2l0aW9uIiwicmVtb3ZlRWxlbWVudCIsIm9iaiIsInBhcmVudEVsZW1lbnQiLCJyZW1vdmVDaGlsZCIsIk1vZGFsIiwibW9kYWxTZXR0aW5ncyIsImlzRml4ZWQiLCJsaW5rU2VsZWN0b3IiLCJzZWxmIiwia2V5IiwiaGFzT3duUHJvcGVydHkiLCJvcGVuIiwicHJvdG90eXBlIiwiY2FsbCIsImdldENvbXB1dGVkU3R5bGUiLCJoZWlnaHQiLCJpbm5lckhlaWdodCIsImNsYXNzTGlzdCIsIm1hdGNoIiwiYWRkIiwicmVtb3ZlIiwiY2xhc3NBIiwiY2xhc3NCIiwic3RyaW5nIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJwYXJlbnROb2RlIl0sIm1hcHBpbmdzIjoiQUFDQSxHQUFJQSxpQkFBbUIsV0E4RHJCLFFBQVNDLEdBQW9CQyxHQUMzQixHQUFJQyxHQUFXLEVBQ1hDLEVBQU9GLEVBQUVHLGNBQ1RDLEVBQVNGLEVBQUtHLGlCQUFpQixtQkFDL0JDLEVB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LFVBQVVFLElBQUlwQyxHQUNUUixTQUFTc0IsRUFBSWQsS0FBWWMsRUFBR2QsV0FBYSxJQUFNQSxHQUczRCxRQUFTN0UsYUFBWTJGLEVBQUlkLEdBQ3ZCLEdBQUljLEVBQUdvQixVQUNMcEIsRUFBR29CLFVBQVVHLE9BQU9yQyxPQUNqQixJQUFJUixTQUFTc0IsRUFBSWQsR0FBWSxDQUNoQyxHQUFJOUMsR0FBTSxHQUFJQyxRQUFPLFVBQVk2QyxFQUFZLFVBQzdDYyxHQUFHZCxVQUFZYyxFQUFHZCxVQUFVeEQsUUFBUVUsRUFBSyxNQUk3QyxRQUFTdUIsV0FBVXFDLEVBQUl3QixFQUFRQyxHQUM3QnBILFlBQVkyRixFQUFJd0IsR0FDaEJwRyxTQUFTNEUsRUFBSXlCLEdBSWYsUUFBU2xHLGlCQUFnQm1HLEdBQ3JCLE1BQU9BLEdBQU9DLE9BQU8sR0FBR0MsY0FBZ0JGLEVBQU8xRyxNQUFNLEdBSXpELFFBQVNtRixlQUFjSCxHQUNqQkEsR0FDRkEsRUFBRzZCLFdBQVd2QixZQUFZTiIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIERlcGVuZHMgb24gdXRpbHMuanNcbnZhciBfRm9ybVZhbGlkYXRpb24gPSAoZnVuY3Rpb24gRm9ybVZhbGlkYXRpb24oKSB7XG4gIHZhciB2YWxpZGF0b3JMaXN0ID0ge1xuICAgICdyZXF1aXJlZCc6IHtcbiAgICAgICdlcnJvcic6ICc8ZmllbGQ+IGlzIHJlcXVpcmVkLiAnLFxuICAgICAgJ3ZhbGlkYXRvcic6ICBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgICAgfVxuICAgIH0sXG4gICAgJ25vdF9lbXB0eSc6IHtcbiAgICAgICdlcnJvcic6ICc8ZmllbGQ+IGNhbm5vdCBiZSBvbmx5IHNwYWNlcy4gJyxcbiAgICAgICd2YWxpZGF0b3InOiAgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiAvXFxTLy50ZXN0KGlucHV0KTtcbiAgICAgIH1cbiAgICB9LFxuICAgICdtaW4nOiB7XG4gICAgICAnZXJyb3InOiAnPGZpZWxkPiBjYW5ub3QgYmUgc2hvcnRlciB0aGFuIDwxPiBjaGFyYWN0ZXJzLiAnLFxuICAgICAgJ3ZhbGlkYXRvcic6IGZ1bmN0aW9uIChpbnB1dCwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBpbnB1dC5sZW5ndGggPj0gbGVuZ3RoO1xuICAgICAgfVxuICAgIH0sXG4gICAgJ21heCc6IHtcbiAgICAgICdlcnJvcic6ICc8ZmllbGQ+IGNhbm5vdCBiZSBsb25nZXIgdGhhbiA8MT4gY2hhcmFjdGVycy4gJyxcbiAgICAgICd2YWxpZGF0b3InOiBmdW5jdGlvbiAoaW5wdXQsIGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gaW5wdXQubGVuZ3RoIDw9IGxlbmd0aDtcbiAgICAgIH1cbiAgICB9LFxuICAgICd1c2VybmFtZV9jaGFycyc6IHtcbiAgICAgICdlcnJvcic6ICc8ZmllbGQ+IG1heSBvbmx5IGNvbnRhaW4gbGV0dGVycywgbnVtYmVycywgb3IgdGhlc2Ugc3BlY2lhbCBjaGFyYWN0ZXJzOiBfLishKigpLSAnLFxuICAgICAgJ3ZhbGlkYXRvcic6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cCgnXltBLVphLXowLTlfLishKigpLV0rJCcpO1xuICAgICAgICByZXR1cm4gcmVnLnRlc3QoaW5wdXQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgJ25vX3JlcGVhdGVkX3VuZGVyc2NvcmVzJzoge1xuICAgICAgJ2Vycm9yJzogJzxmaWVsZD4gbWF5IG5vdCBjb250YWluIHR3byB1bmRlcnNjb3JlcyBpbiBhIHJvdy4gJyxcbiAgICAgICd2YWxpZGF0b3InOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0LmluZGV4T2YoJ19fJykgPCAwO1xuICAgICAgfVxuICAgIH0sXG4gICAgJ21hdGNoX3Bhc3N3b3JkJzoge1xuICAgICAgJ2Vycm9yJzogJ1Bhc3N3b3JkcyBtdXN0IG1hdGNoLiAnLFxuICAgICAgJ3ZhbGlkYXRvcic6IGZ1bmN0aW9uIChpbnB1dCwgbWF0Y2hfaWQpIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG1hdGNoX2lkKS52YWx1ZSA9PT0gaW5wdXQ7XG4gICAgICB9XG4gICAgfSxcbiAgICAnZW1haWwnOiB7XG4gICAgICAnZXJyb3InOiAnPGZpZWxkPiBtdXN0IGJlIGEgdmFsaWQgZW1haWwuICcsXG4gICAgICAndmFsaWRhdG9yJzogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiAvXFxTK0BcXFMrXFwuXFxTKy8udGVzdChpbnB1dCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBmdW5jdGlvbiBGb3JtVmFsaWRhdGlvbkNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYmluZCA9IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICB2YXIgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZm9ybXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9ybXNbaV0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgX2Zvcm1TdWJtaXRMaXN0ZW5lcik7IC8vIEVuZCBldmVudCBsaXN0ZW5lclxuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgZnVuY3Rpb24gX2Zvcm1TdWJtaXRMaXN0ZW5lcihlKSB7XG4gICAgdmFyIGVyckNvdW50ID0gMDtcbiAgICB2YXIgZm9ybSA9IGUuY3VycmVudFRhcmdldDtcbiAgICB2YXIgZmllbGRzID0gZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCwgdGV4dGFyZWEnKTtcbiAgICB2YXIgZXJyb3JDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmb3JtLmdldEF0dHJpYnV0ZSgnZGF0YS1lcnJvci1pZCcpKTtcbiAgICBpZiAoZXJyb3JDb250YWluZXIpIHtcbiAgICAgIGVycm9yQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xuICAgIH1cbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZpZWxkcy5sZW5ndGg7IGorKykge1xuICAgICAgdmFyIHZhbGlkYXRvcnMgPSBmaWVsZHNbal0uZ2V0QXR0cmlidXRlKCdkYXRhLXZhbGlkYXRvcnMnKTtcbiAgICAgIHZhciBlcnJvcnMgPSBmaWVsZHNbal0uZ2V0QXR0cmlidXRlKCdkYXRhLWVycm9ycycpO1xuICAgICAgaWYgKGVycm9ycykge1xuICAgICAgICBlcnJvcnMgPSBKU09OLnBhcnNlKGVycm9ycyk7XG4gICAgICB9XG4gICAgICBpZiAodmFsaWRhdG9ycykge1xuICAgICAgICByZW1vdmVDbGFzcyhmaWVsZHNbal0sICdlcnJvcicpO1xuICAgICAgICB2YWxpZGF0b3JzID0gdmFsaWRhdG9ycy5zcGxpdChcIiBcIik7XG4gICAgICAgIHZhciBub0Vycm9ycyA9IHRydWU7XG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBub0Vycm9ycyAmJiBrIDwgdmFsaWRhdG9ycy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgIHZhciBwYXJhbXMgPSB2YWxpZGF0b3JzW2tdLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgICB2YXIgdmFsaWRhdG9yTmFtZSA9IHBhcmFtc1swXTtcbiAgICAgICAgICBpZighdmFsaWRhdG9yTGlzdFt2YWxpZGF0b3JOYW1lXSkge1xuICAgICAgICAgICAgdGhyb3cgXCJJbnZhbGlkIHZhbGlkYXRvciB0eXBlOiBcIiArIHZhbGlkYXRvck5hbWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHZhbHVlID0gZmllbGRzW2pdLnZhbHVlO1xuICAgICAgICAgIGlmIChmaWVsZHNbal0udHlwZSA9PSAnY2hlY2tib3gnKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IGZpZWxkc1tqXS5jaGVja2VkO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFtpbnB1dCwgcDEsIHAyLCAuLi5dXG4gICAgICAgICAgcGFyYW1zID0gW3ZhbHVlXS5jb25jYXQocGFyYW1zLnNsaWNlKDEpKTtcblxuICAgICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgdmFsaWRhdGlvbiBmYWlsc1xuICAgICAgICAgIGlmICghdmFsaWRhdG9yTGlzdFt2YWxpZGF0b3JOYW1lXS52YWxpZGF0b3IuYXBwbHkodGhpcywgcGFyYW1zKSkge1xuICAgICAgICAgICAgYWRkQ2xhc3MoZmllbGRzW2pdLCAnZXJyb3InKTtcbiAgICAgICAgICAgIHZhciBmaWVsZCA9IGNhcGl0YWxpemVGaXJzdChmaWVsZHNbal0ubmFtZSk7XG4gICAgICAgICAgICB2YXIgZXJyO1xuICAgICAgICAgICAgaWYgKGVycm9ycyAmJiB2YWxpZGF0b3JOYW1lIGluIGVycm9ycykge1xuICAgICAgICAgICAgICBlcnIgPSBlcnJvcnNbdmFsaWRhdG9yTmFtZV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlcnIgPSB2YWxpZGF0b3JMaXN0W3ZhbGlkYXRvck5hbWVdLmVycm9yLnJlcGxhY2UoJzxmaWVsZD4nLCBmaWVsZC5yZXBsYWNlKC9bXy1dL2csICcgJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgbCA9IDE7IGwgPCBwYXJhbXMubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgICAgICAgZXJyID0gZXJyLnJlcGxhY2UoJzwnICsgbCArICc+JywgcGFyYW1zW2xdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVyckNvdW50Kys7XG4gICAgICAgICAgICBub0Vycm9ycyA9IGZhbHNlO1xuICAgICAgICAgICAgZXJyb3JDb250YWluZXIuaW5uZXJIVE1MICs9ICc8cCBjbGFzcz1cImVycm9yXCI+JyArIGVyciArICc8L3A+JztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVyckNvdW50ID4gMCkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufSgpKTtcblxudmFyIEZvcm1WYWxpZGF0aW9uID0gbmV3IF9Gb3JtVmFsaWRhdGlvbigpO1xuIiwid2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmaXhOYXZiYXIpO1xuXG4gIC8vIEdldCBhbGwgb2YgdGhlIHJpZ2h0IG5hdmJhciBsaW5rcyBhbmQgYmluZCBjbGljayBldmVudHMgdG8gdGhlbVxuICBpbml0aWFsaXplUmlnaHRNZW51KCk7XG5cbiAgLy8gRm9ybSBWYWxpZGF0aW9uXG4gIEZvcm1WYWxpZGF0aW9uLmJpbmQoJy52YWxpZGF0ZWQtZm9ybScpO1xufSk7XG5cbi8vIE1ha2UgbmF2aWdhdGlvbiBiYXIgc3RheSBhdCB0aGUgdG9wXG5mdW5jdGlvbiBmaXhOYXZiYXIoZSkge1xuICB2YXIgdG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYW5uZXJcIikub2Zmc2V0SGVpZ2h0O1xuICB2YXIgc2lkZWJhcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNpZGViYXItY29udGFpbmVyXCIpO1xuICBpZiAoZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPiB0b3AgfHxcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID4gdG9wKSB7XG4gICAgYWRkQ2xhc3MoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYXZiYXJcIiksIFwiZml4ZWRcIik7XG4gICAgaWYgKHNpZGViYXJzKSB7XG4gICAgICBhZGRDbGFzcyhzaWRlYmFycywgXCJmaXhlZFwiKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmVtb3ZlQ2xhc3MoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYXZiYXJcIiksIFwiZml4ZWRcIik7XG4gICAgaWYgKHNpZGViYXJzKSB7XG4gICAgICByZW1vdmVDbGFzcyhzaWRlYmFycywgXCJmaXhlZFwiKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdGlhbGl6ZVJpZ2h0TWVudSgpIHtcbiAgdmFyIG5hdmlnYXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmF2aWdhdGlvbi1yaWdodCcpO1xuICB2YXIgbWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wZG93bi1yaWdodCcpO1xuICB2YXIgbGlua3MgPSBuYXZpZ2F0aW9uLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Jsb2NrLWxpbmsnKTtcbiAgdmFyIHNlY3Rpb25zID0gbWVudS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtZW51Jyk7XG5cbiAgLy8gRm9yIHRocm91Z2ggcmlnaHQgbmF2aWdhdGlvbiBsaW5rcyBhbmQgYXR0YWNoIGxpc3RlbmVycyB0byB0aGVtXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcbiAgICBsaW5rc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIGNoYW5nZVJpZ2h0TWVudShlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB2YXIgbGluayA9IGUuY3VycmVudFRhcmdldDtcblxuICAgICAgaWYgKGhhc0NsYXNzKGxpbmssICdhY3RpdmUnKSkge1xuICAgICAgICAvLyBDbGlja2luZyBvbiBhIHNlbGVjdGVkIGljb24gcmVtb3ZlcyB0aGUgbWVudVxuICAgICAgICBoaWRlTWVudSgpO1xuICAgICAgICByZW1vdmVDbGFzcyhsaW5rLCAnYWN0aXZlJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzaG93TWVudShsaW5rLmdldEF0dHJpYnV0ZSgnZGF0YS1zZWN0aW9uJykpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gaGlkZU1lbnUoKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykge1xuICAgICAgcmVtb3ZlQ2xhc3MobGlua3NbaV0sICdhY3RpdmUnKTtcbiAgICB9XG4gICAgc3dhcENsYXNzKG1lbnUsICdzaG93bicsICdoaWRkZW4nKTtcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VPbk91dHNpZGVDbGljaywgZmFsc2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd01lbnUoc2VjdGlvbikge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChsaW5rc1tpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2VjdGlvbicpID09IHNlY3Rpb24pIHtcbiAgICAgICAgYWRkQ2xhc3MobGlua3NbaV0sICdhY3RpdmUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKGxpbmtzW2ldLCAnYWN0aXZlJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzZWN0aW9uc1tpXS5pZCA9PSBzZWN0aW9uKSB7XG4gICAgICAgIHNlY3Rpb25zW2ldLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VjdGlvbnNbaV0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgIH1cbiAgICB9XG4gICAgc3dhcENsYXNzKG1lbnUsICdoaWRkZW4nLCAnc2hvd24nKTtcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VPbk91dHNpZGVDbGljayk7XG4gIH1cblxuICBmdW5jdGlvbiBjbG9zZU9uT3V0c2lkZUNsaWNrIChlKSB7XG4gICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIGlmICghbmF2aWdhdGlvbi5jb250YWlucyh0YXJnZXQpICYmICFtZW51LmNvbnRhaW5zKHRhcmdldCkpIHtcbiAgICAgIGhpZGVNZW51KCk7XG4gICAgfVxuICB9XG59XG4iLCIvKlxuICogQSBzaW1wbHkgbGlicmFyeSBmb3IgYSBKYXZhU2NyaXB0IG1vZGFsIHdpdGggbm8gZGVwZW5kZW5jaWVzLiAgXG4gKi9cbihmdW5jdGlvbiAoZykge1xuICBnLk1vZGFsID0gZnVuY3Rpb24gKG1vZGFsU2V0dGluZ3MpIHtcbiAgICAvLyBBIHJlZmVyZW5jZSB0byB0aGUgbW9kYWwgcGllY2VzIGluIHRoZSBkb21cbiAgICB0aGlzLm1vZGFsID0gbnVsbDtcbiAgICB0aGlzLm92ZXJsYXkgPSBudWxsO1xuICAgIHRoaXMuY2xvc2VCdXR0b24gPSBudWxsO1xuXG4gICAgLy8gSW5pdGlhbGl6ZWQgdG8gYWxsIG9mIHRoZSBkZWZhdWx0cyBmb3IgdGhpcyB0aGluZyFcbiAgICB0aGlzLnNldHRpbmdzID0ge1xuICAgICAgY2xhc3NOYW1lOiBcInpvb21cIixcbiAgICAgIGhhc0Nsb3NlQnV0dG9uOiB0cnVlLFxuICAgICAgY29udGVudDogXCJcIixcbiAgICAgIHRpdGxlOiBudWxsLFxuICAgICAgbWF4V2lkdGg6IDgwMCxcbiAgICAgIG1pbldpZHRoOiAyMDAsXG4gICAgICBoYXNPdmVybGF5OiB0cnVlLFxuICAgICAgaXNGaXhlZDogdHJ1ZSxcbiAgICAgIGxpbmtTZWxlY3RvcjogbnVsbFxuICAgIH07XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICBpZiAobW9kYWxTZXR0aW5ncyAmJiB0eXBlb2YgbW9kYWxTZXR0aW5ncyA9PT0gXCJvYmplY3RcIikge1xuICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuc2V0dGluZ3MpIHtcbiAgICAgICAgaWYgKG1vZGFsU2V0dGluZ3MuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgIHRoaXMuc2V0dGluZ3Nba2V5XSA9IG1vZGFsU2V0dGluZ3Nba2V5XVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGNvbnRlbnQgPSB0aGlzLnNldHRpbmdzLmNvbnRlbnQ7XG4gICAgaWYgKGNvbnRlbnQgJiYgY29udGVudC5pbm5lckhUTUwpIHtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LmlubmVySFRNTDtcbiAgICAgIHJlbW92ZUVsZW1lbnQodGhpcy5zZXR0aW5ncy5jb250ZW50KTtcbiAgICAgIHRoaXMuc2V0dGluZ3MuY29udGVudCA9IGNvbnRlbnQ7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MubGlua1NlbGVjdG9yICE9PSBudWxsKSB7XG4gICAgICB2YXIgbGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuc2V0dGluZ3MubGlua1NlbGVjdG9yKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBsaW5rc1tpXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgc2VsZi5vcGVuKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBNb2RhbC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICBidWlsZE1vZGFsLmNhbGwodGhpcyk7XG4gICAgaW5pdGlhbGl6ZUV2ZW50cy5jYWxsKHRoaXMpO1xuXG4gICAgLy8gRm9yIGFuaW1hdGlvbnNcbiAgICB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLm1vZGFsKS5oZWlnaHQ7XG5cbiAgICB0aGlzLm1vZGFsLmNsYXNzTmFtZSArPSB0aGlzLm1vZGFsLm9mZnNldEhlaWdodCA+IHdpbmRvdy5pbm5lckhlaWdodCA/XG4gICAgICBcIiBtb2RhbC1hY3RpdmUgbW9kYWwtYW5jaG9yZWRcIiA6IFwiIG1vZGFsLWFjdGl2ZVwiO1xuICAgIGlmICh0aGlzLm92ZXJsYXkpIHtcbiAgICAgIHRoaXMub3ZlcmxheS5jbGFzc05hbWUgKz0gXCIgbW9kYWwtYWN0aXZlXCI7XG4gICAgfVxuICB9O1xuXG4gIE1vZGFsLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICB0aGlzLm1vZGFsLmNsYXNzTmFtZSA9IHRoaXMubW9kYWwuY2xhc3NOYW1lLnJlcGxhY2UoXCIgbW9kYWwtYWN0aXZlXCIsIFwiXCIpO1xuXG4gICAgdGhpcy5tb2RhbC5hZGRFdmVudExpc3RlbmVyKHRyYW5zaXRpb25FbmQoKSwgZnVuY3Rpb24gKCkge1xuICAgICAgcmVtb3ZlRWxlbWVudChzZWxmLm1vZGFsKTtcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLm92ZXJsYXkpIHtcbiAgICAgIHRoaXMub3ZlcmxheS5jbGFzc05hbWUgPSB0aGlzLm92ZXJsYXkuY2xhc3NOYW1lLnJlcGxhY2UoXCIgbW9kYWwtYWN0aXZlXCIsIFwiXCIpO1xuXG4gICAgICB0aGlzLm92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kKCksIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVtb3ZlRWxlbWVudChzZWxmLm92ZXJsYXkpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gYnVpbGRNb2RhbCAoKSB7XG4gICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIHRoaXMubW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRoaXMubW9kYWwuY2xhc3NOYW1lID0gXCJtb2RhbCBcIiArIHRoaXMuc2V0dGluZ3MuY2xhc3NOYW1lO1xuICAgIHRoaXMubW9kYWwuc3R5bGUubWluV2lkdGggPSB0aGlzLnNldHRpbmdzLm1pbldpZHRoICsgXCJweFwiO1xuICAgIHRoaXMubW9kYWwuc3R5bGUubWF4V2lkdGggPSB0aGlzLnNldHRpbmdzLm1heFdpZHRoICsgXCJweFwiO1xuXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuaGFzQ2xvc2VCdXR0b24gPT09IHRydWUpIHtcbiAgICAgIHRoaXMuY2xvc2VCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgdGhpcy5jbG9zZUJ1dHRvbi5jbGFzc05hbWUgPSBcIm1vZGFsLWNsb3NlIG1vZGFsLWNsb3NlLWJ1dHRvblwiO1xuICAgICAgdGhpcy5jbG9zZUJ1dHRvbi5pbm5lckhUTUwgPSBcIsOXXCI7XG4gICAgICB0aGlzLm1vZGFsLmFwcGVuZENoaWxkKHRoaXMuY2xvc2VCdXR0b24pO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnNldHRpbmdzLmhhc092ZXJsYXkgPT09IHRydWUpIHtcbiAgICAgIHRoaXMub3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICB0aGlzLm92ZXJsYXkuY2xhc3NOYW1lID0gXCJtb2RhbC1vdmVybGF5IFwiICsgdGhpcy5zZXR0aW5ncy5jbGFzc05hbWU7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0aGlzLm92ZXJsYXkpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnNldHRpbmdzLnRpdGxlICE9PSBudWxsKSB7XG4gICAgICB2YXIgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDJcIik7XG4gICAgICB0aXRsZS5jbGFzc05hbWUgPSBcIm1vZGFsLXRpdGxlXCI7XG4gICAgICB0aXRsZS5pbm5lckhUTUwgPSB0aGlzLnNldHRpbmdzLnRpdGxlO1xuICAgICAgdGhpcy5tb2RhbC5hcHBlbmRDaGlsZCh0aXRsZSk7XG4gICAgfVxuXG4gICAgdmFyIGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGNvbnRlbnQuY2xhc3NOYW1lID0gXCJtb2RhbC1jb250ZW50XCI7XG4gICAgY29udGVudC5pbm5lckhUTUwgPSB0aGlzLnNldHRpbmdzLmNvbnRlbnQ7XG4gICAgdGhpcy5tb2RhbC5hcHBlbmRDaGlsZChjb250ZW50KTtcblxuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHRoaXMubW9kYWwpO1xuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gIH1cblxuICBmdW5jdGlvbiBpbml0aWFsaXplRXZlbnRzKCkge1xuICAgIGlmICh0aGlzLmNsb3NlQnV0dG9uKSB7XG4gICAgICB0aGlzLmNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZS5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vdmVybGF5KSB7XG4gICAgICB0aGlzLm92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlLmJpbmQodGhpcykpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHRyYW5zaXRpb25FbmQoKSB7XG4gICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBpZiAoZWwuc3R5bGUuV2Via2l0VHJhbnNpdGlvbikgcmV0dXJuIFwid2Via2l0VHJhbnNpdGlvbkVuZFwiO1xuICAgIGlmIChlbC5zdHlsZS5PVHJhbnNpdGlvbikgcmV0dXJuIFwib1RyYW5zaXRpb25FbmRcIjtcbiAgICByZXR1cm4gJ3RyYW5zaXRpb25lbmQnO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlRWxlbWVudCAob2JqKSB7XG4gICAgaWYgKG9iai5wYXJlbnRFbGVtZW50KSB7XG4gICAgICBvYmoucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChvYmopO1xuICAgIH1cbiAgfVxufSh3aW5kb3cpKTtcbiIsIi8vIEZyb20gaHR0cDovL2pha2V0cmVudC5jb20vcG9zdC9hZGRyZW1vdmUtY2xhc3Nlcy1yYXctamF2YXNjcmlwdC9cbmZ1bmN0aW9uIGhhc0NsYXNzKGVsLCBjbGFzc05hbWUpIHtcbiAgaWYgKGVsLmNsYXNzTGlzdClcbiAgICByZXR1cm4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSlcbiAgZWxzZVxuICAgIHJldHVybiAhIWVsLmNsYXNzTmFtZS5tYXRjaChuZXcgUmVnRXhwKCcoXFxcXHN8XiknICsgY2xhc3NOYW1lICsgJyhcXFxcc3wkKScpKVxufVxuXG5mdW5jdGlvbiBhZGRDbGFzcyhlbCwgY2xhc3NOYW1lKSB7XG4gIGlmIChlbC5jbGFzc0xpc3QpXG4gICAgZWwuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpXG4gIGVsc2UgaWYgKCFoYXNDbGFzcyhlbCwgY2xhc3NOYW1lKSkgZWwuY2xhc3NOYW1lICs9IFwiIFwiICsgY2xhc3NOYW1lXG59XG5cbmZ1bmN0aW9uIHJlbW92ZUNsYXNzKGVsLCBjbGFzc05hbWUpIHtcbiAgaWYgKGVsLmNsYXNzTGlzdClcbiAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSlcbiAgZWxzZSBpZiAoaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkpIHtcbiAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cCgnKFxcXFxzfF4pJyArIGNsYXNzTmFtZSArICcoXFxcXHN8JCknKVxuICAgIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKHJlZywgJyAnKVxuICB9XG59XG5cbmZ1bmN0aW9uIHN3YXBDbGFzcyhlbCwgY2xhc3NBLCBjbGFzc0IpIHtcbiAgcmVtb3ZlQ2xhc3MoZWwsIGNsYXNzQSk7XG4gIGFkZENsYXNzKGVsLCBjbGFzc0IpO1xufVxuXG4vLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwMjYwNjkvY2FwaXRhbGl6ZS10aGUtZmlyc3QtbGV0dGVyLW9mLXN0cmluZy1pbi1qYXZhc2NyaXB0XG5mdW5jdGlvbiBjYXBpdGFsaXplRmlyc3Qoc3RyaW5nKSB7XG4gICAgcmV0dXJuIHN0cmluZy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0cmluZy5zbGljZSgxKTtcbn1cblxuLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84ODMwODM5L2phdmFzY3JpcHQtZG9tLXJlbW92ZS1lbGVtZW50XG5mdW5jdGlvbiByZW1vdmVFbGVtZW50KGVsKSB7XG4gIGlmIChlbCkge1xuICAgIGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
