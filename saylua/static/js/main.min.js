var _FormValidation=function(){function r(r){var t=0,a=r.currentTarget,n=a.querySelectorAll("input, textarea"),o=document.getElementById(a.getAttribute("data-error-id"));o&&(o.innerHTML="");for(var i=0;i<n.length;i++){var l=n[i].getAttribute("data-validators"),c=n[i].getAttribute("data-errors");if(c&&(c=JSON.parse(c)),l){removeClass(n[i],"error"),l=l.split(" ");for(var d=!0,s=0;d&&s<l.length;s++){var u=l[s].split(":"),v=u[0];if(!e[v])throw"Invalid validator type: "+v;var f=n[i].value;if("checkbox"==n[i].type&&(f=n[i].checked),u=[f].concat(u.slice(1)),!e[v].validator.apply(this,u)){addClass(n[i],"error");var m,h=capitalizeFirst(n[i].name);m=c&&v in c?c[v]:e[v].error.replace("<field>",h.replace(/[_-]/g," "));for(var p=1;p<u.length;p++)m=m.replace("<"+p+">",u[p]);t++,d=!1,o.innerHTML+='<p class="error">'+m+"</p>"}}}}return!(t>0)||(r.preventDefault(),!1)}var e={required:{error:"<field> is required. ",validator:function(r){return r}},not_empty:{error:"<field> cannot be only spaces. ",validator:function(r){return/\S/.test(r)}},min:{error:"<field> cannot be shorter than <1> characters. ",validator:function(r,e){return r.length>=e}},max:{error:"<field> cannot be longer than <1> characters. ",validator:function(r,e){return r.length<=e}},username_chars:{error:"<field> may only contain letters, numbers, or these special characters: _.+!*()- ",validator:function(r){var e=new RegExp("^[A-Za-z0-9_.+!*()-]+$");return e.test(r)}},no_repeated_underscores:{error:"<field> may not contain two underscores in a row. ",validator:function(r){return r.indexOf("__")<0}},match_password:{error:"Passwords must match. ",validator:function(r,e){return document.getElementById(e).value===r}},email:{error:"<field> must be a valid email. ",validator:function(r){return/\S+@\S+\.\S+/.test(r)}}};return function(){this.bind=function(e){for(var t=document.querySelectorAll(e),a=0;a<t.length;a++)t[a].addEventListener("submit",r)}}}(),FormValidation=new _FormValidation;
function fixNavbar(e){var n=document.getElementById("banner").offsetHeight,t=document.getElementById("sidebar-container");document.body.scrollTop>n||document.documentElement.scrollTop>n?(addClass(document.getElementById("navbar"),"fixed"),t&&addClass(t,"fixed")):(removeClass(document.getElementById("navbar"),"fixed"),t&&removeClass(t,"fixed"))}function initializeMenu(e,n){function t(){swapClass(n,"hidden","shown"),addClass(e,"active"),document.body.addEventListener("click",a)}function i(t){swapClass(n,"shown","hidden"),removeClass(e,"active"),document.body.removeEventListener("click",a,!1)}function a(t){var a=t.target;e.contains(a)||n.contains(a)||i()}e.addEventListener("click",function(a){return!n||(a.preventDefault(),void(hasClass(e,"active")?i():t()))})}function initializeRightMenu(){function e(){for(var e=0;e<d.length;e++)removeClass(d[e],"active");swapClass(a,"shown","hidden"),document.body.removeEventListener("click",t,!1)}function n(e){for(var n=0;n<d.length;n++)d[n].getAttribute("data-section")==e?addClass(d[n],"active"):removeClass(d[n],"active");for(var n=0;n<o.length;n++)o[n].id==e?o[n].style.display="block":o[n].style.display="none";swapClass(a,"hidden","shown"),document.body.addEventListener("click",t)}function t(n){var t=n.target;i.contains(t)||a.contains(t)||e()}for(var i=document.getElementById("navigation-right"),a=document.getElementById("dropdown-right"),d=i.getElementsByClassName("block-link"),o=a.getElementsByClassName("menu"),s=0;s<d.length;s++)d[s].addEventListener("click",function(t){t.preventDefault();var i=t.currentTarget;hasClass(i,"active")?(e(),removeClass(i,"active")):n(i.getAttribute("data-section"))})}window.addEventListener("load",function(){window.addEventListener("scroll",fixNavbar),initializeRightMenu(),initializeMenu(document.getElementById("hamburger-menu-link"),document.getElementById("nav-links")),initializeMenu(document.getElementById("sidebar-menu-link"),document.getElementById("sidebar-container")),FormValidation.bind(".validated-form")});
!function(t){function e(){var t=document.createDocumentFragment();if(this.modal=document.createElement("div"),this.modal.className="modal "+this.settings.className,this.modal.style.minWidth=this.settings.minWidth+"px",this.modal.style.maxWidth=this.settings.maxWidth+"px",this.settings.hasCloseButton===!0&&(this.closeButton=document.createElement("button"),this.closeButton.className="modal-close modal-close-button",this.closeButton.innerHTML="Ã—",this.modal.appendChild(this.closeButton)),this.settings.hasOverlay===!0&&(this.overlay=document.createElement("div"),this.overlay.className="modal-overlay "+this.settings.className,t.appendChild(this.overlay)),null!==this.settings.title){var e=document.createElement("h2");e.className="modal-title",e.innerHTML=this.settings.title,this.modal.appendChild(e)}var i=document.createElement("div");i.className="modal-content",i.innerHTML=this.settings.content,this.modal.appendChild(i),t.appendChild(this.modal),document.body.appendChild(t)}function i(){this.closeButton&&this.closeButton.addEventListener("click",this.close.bind(this)),this.overlay&&this.overlay.addEventListener("click",this.close.bind(this))}function s(){var t=document.createElement("div");return t.style.WebkitTransition?"webkitTransitionEnd":t.style.OTransition?"oTransitionEnd":"transitionend"}function n(t){t.parentElement&&t.parentElement.removeChild(t)}t.Modal=function(t){this.modal=null,this.overlay=null,this.closeButton=null,this.settings={className:"zoom",hasCloseButton:!0,content:"",title:null,maxWidth:800,minWidth:200,hasOverlay:!0,isFixed:!0,linkSelector:null};var e=this;if(t&&"object"==typeof t)for(var i in this.settings)t.hasOwnProperty(i)&&(this.settings[i]=t[i]);var s=this.settings.content;if(s&&s.innerHTML&&(s=s.innerHTML,n(this.settings.content),this.settings.content=s),null!==this.settings.linkSelector)for(var l=document.querySelectorAll(this.settings.linkSelector),a=0;a<l.length;a++)l[a].addEventListener("click",function(t){t.preventDefault(),e.open()})},Modal.prototype.open=function(){e.call(this),i.call(this),window.getComputedStyle(this.modal).height,this.modal.className+=this.modal.offsetHeight>window.innerHeight?" modal-active modal-anchored":" modal-active",this.overlay&&(this.overlay.className+=" modal-active")},Modal.prototype.close=function(){var t=this;this.modal.className=this.modal.className.replace(" modal-active",""),this.modal.addEventListener(s(),function(){n(t.modal)}),this.overlay&&(this.overlay.className=this.overlay.className.replace(" modal-active",""),this.overlay.addEventListener(s(),function(){n(t.overlay)}))}}(window);
function hasClass(s,a){return s.classList?s.classList.contains(a):!!s.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))}function addClass(s,a){s.classList?s.classList.add(a):hasClass(s,a)||(s.className+=" "+a)}function removeClass(s,a){if(s.classList)s.classList.remove(a);else if(hasClass(s,a)){var e=new RegExp("(\\s|^)"+a+"(\\s|$)");s.className=s.className.replace(e," ")}}function swapClass(s,a,e){removeClass(s,a),addClass(s,e)}function capitalizeFirst(s){return s.charAt(0).toUpperCase()+s.slice(1)}function removeElement(s){s&&s.parentNode.removeChild(s)}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZvcm1WYWxpZGF0ZS5qcyIsIm1haW4uanMiLCJtb2RhbC5qcyIsInV0aWxzLmpzIl0sIm5hbWVzIjpbIl9Gb3JtVmFsaWRhdGlvbiIsIl9mb3JtU3VibWl0TGlzdGVuZXIiLCJlIiwiZXJyQ291bnQiLCJmb3JtIiwiY3VycmVudFRhcmdldCIsImZpZWxkcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlcnJvckNvbnRhaW5lciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRBdHRyaWJ1dGUiLCJpbm5lckhUTUwiLCJqIiwibGVuZ3RoIiwidmFsaWRhdG9ycyIsImVycm9ycyIsIkpTT04iLCJwYXJzZSIsInJlbW92ZUNsYXNzIiwic3BsaXQiLCJub0Vycm9ycyIsImsiLCJwYXJhbXMiLCJ2YWxpZGF0b3JOYW1lIiwidmFsaWRhdG9yTGlzdCIsInZhbHVlIiwidHlwZSIsImNoZWNrZWQiLCJjb25jYXQiLCJzbGljZSIsInZhbGlkYXRvciIsImFwcGx5IiwidGhpcyIsImFkZENsYXNzIiwiZXJyIiwiZmllbGQiLCJjYXBpdGFsaXplRmlyc3QiLCJuYW1lIiwiZXJyb3IiLCJyZXBsYWNlIiwibCIsInByZXZlbnREZWZhdWx0IiwicmVxdWlyZWQiLCJpbnB1dCIsIm5vdF9lbXB0eSIsInRlc3QiLCJtaW4iLCJtYXgiLCJ1c2VybmFtZV9jaGFycyIsInJlZyIsIlJlZ0V4cCIsIm5vX3JlcGVhdGVkX3VuZGVyc2NvcmVzIiwiaW5kZXhPZiIsIm1hdGNoX3Bhc3N3b3JkIiwibWF0Y2hfaWQiLCJlbWFpbCIsImJpbmQiLCJzZWxlY3RvciIsImZvcm1zIiwiaSIsImFkZEV2ZW50TGlzdGVuZXIiLCJGb3JtVmFsaWRhdGlvbiIsImZpeE5hdmJhciIsInRvcCIsIm9mZnNldEhlaWdodCIsInNpZGViYXJzIiwiYm9keSIsInNjcm9sbFRvcCIsImRvY3VtZW50RWxlbWVudCIsImluaXRpYWxpemVNZW51IiwibGluayIsIm1lbnUiLCJzaG93TWVudSIsInN3YXBDbGFzcyIsImNsb3NlT25PdXRzaWRlQ2xpY2siLCJoaWRlTWVudSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ0YXJnZXQiLCJjb250YWlucyIsImhhc0NsYXNzIiwiaW5pdGlhbGl6ZVJpZ2h0TWVudSIsImxpbmtzIiwic2VjdGlvbiIsInNlY3Rpb25zIiwiaWQiLCJzdHlsZSIsImRpc3BsYXkiLCJuYXZpZ2F0aW9uIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsIndpbmRvdyIsImciLCJidWlsZE1vZGFsIiwiZnJhZ21lbnQiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwibW9kYWwiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwic2V0dGluZ3MiLCJtaW5XaWR0aCIsIm1heFdpZHRoIiwiaGFzQ2xvc2VCdXR0b24iLCJjbG9zZUJ1dHRvbiIsImFwcGVuZENoaWxkIiwiaGFzT3ZlcmxheSIsIm92ZXJsYXkiLCJ0aXRsZSIsImNvbnRlbnQiLCJpbml0aWFsaXplRXZlbnRzIiwiY2xvc2UiLCJ0cmFuc2l0aW9uRW5kIiwiZWwiLCJXZWJraXRUcmFuc2l0aW9uIiwiT1RyYW5zaXRpb24iLCJyZW1vdmVFbGVtZW50Iiwib2JqIiwicGFyZW50RWxlbWVudCIsInJlbW92ZUNoaWxkIiwiTW9kYWwiLCJtb2RhbFNldHRpbmdzIiwiaXNGaXhlZCIsImxpbmtTZWxlY3RvciIsInNlbGYiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsIm9wZW4iLCJwcm90b3R5cGUiLCJjYWxsIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImhlaWdodCIsImlubmVySGVpZ2h0IiwiY2xhc3NMaXN0IiwibWF0Y2giLCJhZGQiLCJyZW1vdmUiLCJjbGFzc0EiLCJjbGFzc0IiLCJzdHJpbmciLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInBhcmVudE5vZGUiXSwibWFwcGluZ3MiOiJBQUNBLEdBQUlBLGlCQUFtQixXQThEckIsUUFBU0MsR0FBb0JDLEdBQzNCLEdBQUlDLEdBQVcsRUFDWEMsRUFBT0YsRUFBRUcsY0FDVEMsRUFBU0YsRUFBS0cs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M0csTUFBTSxHQUl6RCxRQUFTb0YsZUFBY0gsR0FDakJBLEdBQ0ZBLEVBQUc2QixXQUFXdkIsWUFBWU4iLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBEZXBlbmRzIG9uIHV0aWxzLmpzXG52YXIgX0Zvcm1WYWxpZGF0aW9uID0gKGZ1bmN0aW9uIEZvcm1WYWxpZGF0aW9uKCkge1xuICB2YXIgdmFsaWRhdG9yTGlzdCA9IHtcbiAgICAncmVxdWlyZWQnOiB7XG4gICAgICAnZXJyb3InOiAnPGZpZWxkPiBpcyByZXF1aXJlZC4gJyxcbiAgICAgICd2YWxpZGF0b3InOiAgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICAgIH1cbiAgICB9LFxuICAgICdub3RfZW1wdHknOiB7XG4gICAgICAnZXJyb3InOiAnPGZpZWxkPiBjYW5ub3QgYmUgb25seSBzcGFjZXMuICcsXG4gICAgICAndmFsaWRhdG9yJzogIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICByZXR1cm4gL1xcUy8udGVzdChpbnB1dCk7XG4gICAgICB9XG4gICAgfSxcbiAgICAnbWluJzoge1xuICAgICAgJ2Vycm9yJzogJzxmaWVsZD4gY2Fubm90IGJlIHNob3J0ZXIgdGhhbiA8MT4gY2hhcmFjdGVycy4gJyxcbiAgICAgICd2YWxpZGF0b3InOiBmdW5jdGlvbiAoaW5wdXQsIGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gaW5wdXQubGVuZ3RoID49IGxlbmd0aDtcbiAgICAgIH1cbiAgICB9LFxuICAgICdtYXgnOiB7XG4gICAgICAnZXJyb3InOiAnPGZpZWxkPiBjYW5ub3QgYmUgbG9uZ2VyIHRoYW4gPDE+IGNoYXJhY3RlcnMuICcsXG4gICAgICAndmFsaWRhdG9yJzogZnVuY3Rpb24gKGlucHV0LCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0Lmxlbmd0aCA8PSBsZW5ndGg7XG4gICAgICB9XG4gICAgfSxcbiAgICAndXNlcm5hbWVfY2hhcnMnOiB7XG4gICAgICAnZXJyb3InOiAnPGZpZWxkPiBtYXkgb25seSBjb250YWluIGxldHRlcnMsIG51bWJlcnMsIG9yIHRoZXNlIHNwZWNpYWwgY2hhcmFjdGVyczogXy4rISooKS0gJyxcbiAgICAgICd2YWxpZGF0b3InOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoJ15bQS1aYS16MC05Xy4rISooKS1dKyQnKTtcbiAgICAgICAgcmV0dXJuIHJlZy50ZXN0KGlucHV0KTtcbiAgICAgIH1cbiAgICB9LFxuICAgICdub19yZXBlYXRlZF91bmRlcnNjb3Jlcyc6IHtcbiAgICAgICdlcnJvcic6ICc8ZmllbGQ+IG1heSBub3QgY29udGFpbiB0d28gdW5kZXJzY29yZXMgaW4gYSByb3cuICcsXG4gICAgICAndmFsaWRhdG9yJzogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiBpbnB1dC5pbmRleE9mKCdfXycpIDwgMDtcbiAgICAgIH1cbiAgICB9LFxuICAgICdtYXRjaF9wYXNzd29yZCc6IHtcbiAgICAgICdlcnJvcic6ICdQYXNzd29yZHMgbXVzdCBtYXRjaC4gJyxcbiAgICAgICd2YWxpZGF0b3InOiBmdW5jdGlvbiAoaW5wdXQsIG1hdGNoX2lkKSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtYXRjaF9pZCkudmFsdWUgPT09IGlucHV0O1xuICAgICAgfVxuICAgIH0sXG4gICAgJ2VtYWlsJzoge1xuICAgICAgJ2Vycm9yJzogJzxmaWVsZD4gbXVzdCBiZSBhIHZhbGlkIGVtYWlsLiAnLFxuICAgICAgJ3ZhbGlkYXRvcic6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICByZXR1cm4gL1xcUytAXFxTK1xcLlxcUysvLnRlc3QoaW5wdXQpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gZnVuY3Rpb24gRm9ybVZhbGlkYXRpb25Db25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmJpbmQgPSBmdW5jdGlvbihzZWxlY3Rvcikge1xuICAgICAgdmFyIGZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZvcm1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvcm1zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIF9mb3JtU3VibWl0TGlzdGVuZXIpOyAvLyBFbmQgZXZlbnQgbGlzdGVuZXJcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIF9mb3JtU3VibWl0TGlzdGVuZXIoZSkge1xuICAgIHZhciBlcnJDb3VudCA9IDA7XG4gICAgdmFyIGZvcm0gPSBlLmN1cnJlbnRUYXJnZXQ7XG4gICAgdmFyIGZpZWxkcyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHRleHRhcmVhJyk7XG4gICAgdmFyIGVycm9yQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZm9ybS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZXJyb3ItaWQnKSk7XG4gICAgaWYgKGVycm9yQ29udGFpbmVyKSB7XG4gICAgICBlcnJvckNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcbiAgICB9XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBmaWVsZHMubGVuZ3RoOyBqKyspIHtcbiAgICAgIHZhciB2YWxpZGF0b3JzID0gZmllbGRzW2pdLmdldEF0dHJpYnV0ZSgnZGF0YS12YWxpZGF0b3JzJyk7XG4gICAgICB2YXIgZXJyb3JzID0gZmllbGRzW2pdLmdldEF0dHJpYnV0ZSgnZGF0YS1lcnJvcnMnKTtcbiAgICAgIGlmIChlcnJvcnMpIHtcbiAgICAgICAgZXJyb3JzID0gSlNPTi5wYXJzZShlcnJvcnMpO1xuICAgICAgfVxuICAgICAgaWYgKHZhbGlkYXRvcnMpIHtcbiAgICAgICAgcmVtb3ZlQ2xhc3MoZmllbGRzW2pdLCAnZXJyb3InKTtcbiAgICAgICAgdmFsaWRhdG9ycyA9IHZhbGlkYXRvcnMuc3BsaXQoXCIgXCIpO1xuICAgICAgICB2YXIgbm9FcnJvcnMgPSB0cnVlO1xuICAgICAgICBmb3IgKHZhciBrID0gMDsgbm9FcnJvcnMgJiYgayA8IHZhbGlkYXRvcnMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICB2YXIgcGFyYW1zID0gdmFsaWRhdG9yc1trXS5zcGxpdChcIjpcIik7XG4gICAgICAgICAgdmFyIHZhbGlkYXRvck5hbWUgPSBwYXJhbXNbMF07XG4gICAgICAgICAgaWYoIXZhbGlkYXRvckxpc3RbdmFsaWRhdG9yTmFtZV0pIHtcbiAgICAgICAgICAgIHRocm93IFwiSW52YWxpZCB2YWxpZGF0b3IgdHlwZTogXCIgKyB2YWxpZGF0b3JOYW1lO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciB2YWx1ZSA9IGZpZWxkc1tqXS52YWx1ZTtcbiAgICAgICAgICBpZiAoZmllbGRzW2pdLnR5cGUgPT0gJ2NoZWNrYm94Jykge1xuICAgICAgICAgICAgdmFsdWUgPSBmaWVsZHNbal0uY2hlY2tlZDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBbaW5wdXQsIHAxLCBwMiwgLi4uXVxuICAgICAgICAgIHBhcmFtcyA9IFt2YWx1ZV0uY29uY2F0KHBhcmFtcy5zbGljZSgxKSk7XG5cbiAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIHZhbGlkYXRpb24gZmFpbHNcbiAgICAgICAgICBpZiAoIXZhbGlkYXRvckxpc3RbdmFsaWRhdG9yTmFtZV0udmFsaWRhdG9yLmFwcGx5KHRoaXMsIHBhcmFtcykpIHtcbiAgICAgICAgICAgIGFkZENsYXNzKGZpZWxkc1tqXSwgJ2Vycm9yJyk7XG4gICAgICAgICAgICB2YXIgZmllbGQgPSBjYXBpdGFsaXplRmlyc3QoZmllbGRzW2pdLm5hbWUpO1xuICAgICAgICAgICAgdmFyIGVycjtcbiAgICAgICAgICAgIGlmIChlcnJvcnMgJiYgdmFsaWRhdG9yTmFtZSBpbiBlcnJvcnMpIHtcbiAgICAgICAgICAgICAgZXJyID0gZXJyb3JzW3ZhbGlkYXRvck5hbWVdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZXJyID0gdmFsaWRhdG9yTGlzdFt2YWxpZGF0b3JOYW1lXS5lcnJvci5yZXBsYWNlKCc8ZmllbGQ+JywgZmllbGQucmVwbGFjZSgvW18tXS9nLCAnICcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGwgPSAxOyBsIDwgcGFyYW1zLmxlbmd0aDsgbCsrKSB7XG4gICAgICAgICAgICAgIGVyciA9IGVyci5yZXBsYWNlKCc8JyArIGwgKyAnPicsIHBhcmFtc1tsXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlcnJDb3VudCsrO1xuICAgICAgICAgICAgbm9FcnJvcnMgPSBmYWxzZTtcbiAgICAgICAgICAgIGVycm9yQ29udGFpbmVyLmlubmVySFRNTCArPSAnPHAgY2xhc3M9XCJlcnJvclwiPicgKyBlcnIgKyAnPC9wPic7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChlcnJDb3VudCA+IDApIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn0oKSk7XG5cbnZhciBGb3JtVmFsaWRhdGlvbiA9IG5ldyBfRm9ybVZhbGlkYXRpb24oKTtcbiIsIndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZml4TmF2YmFyKTtcblxuICAvLyBHZXQgYWxsIG9mIHRoZSByaWdodCBuYXZiYXIgbGlua3MgYW5kIGJpbmQgY2xpY2sgZXZlbnRzIHRvIHRoZW1cbiAgaW5pdGlhbGl6ZVJpZ2h0TWVudSgpO1xuXG4gIGluaXRpYWxpemVNZW51KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoYW1idXJnZXItbWVudS1saW5rJyksIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXYtbGlua3MnKSk7XG4gIGluaXRpYWxpemVNZW51KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaWRlYmFyLW1lbnUtbGluaycpLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2lkZWJhci1jb250YWluZXInKSk7XG5cbiAgLy8gRm9ybSBWYWxpZGF0aW9uXG4gIEZvcm1WYWxpZGF0aW9uLmJpbmQoJy52YWxpZGF0ZWQtZm9ybScpO1xufSk7XG5cbi8vIE1ha2UgbmF2aWdhdGlvbiBiYXIgc3RheSBhdCB0aGUgdG9wXG5mdW5jdGlvbiBmaXhOYXZiYXIoZSkge1xuICB2YXIgdG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYW5uZXJcIikub2Zmc2V0SGVpZ2h0O1xuICB2YXIgc2lkZWJhcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNpZGViYXItY29udGFpbmVyXCIpO1xuICBpZiAoZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPiB0b3AgfHxcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID4gdG9wKSB7XG4gICAgYWRkQ2xhc3MoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYXZiYXJcIiksIFwiZml4ZWRcIik7XG4gICAgaWYgKHNpZGViYXJzKSB7XG4gICAgICBhZGRDbGFzcyhzaWRlYmFycywgXCJmaXhlZFwiKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmVtb3ZlQ2xhc3MoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYXZiYXJcIiksIFwiZml4ZWRcIik7XG4gICAgaWYgKHNpZGViYXJzKSB7XG4gICAgICByZW1vdmVDbGFzcyhzaWRlYmFycywgXCJmaXhlZFwiKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdGlhbGl6ZU1lbnUobGluaywgbWVudSkge1xuICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICBpZiAoIW1lbnUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKGhhc0NsYXNzKGxpbmssICdhY3RpdmUnKSkge1xuICAgICAgaGlkZU1lbnUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hvd01lbnUoKTtcbiAgICB9XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIHNob3dNZW51KCkge1xuICAgIHN3YXBDbGFzcyhtZW51LCAnaGlkZGVuJywgJ3Nob3duJyk7XG4gICAgYWRkQ2xhc3MobGluaywgJ2FjdGl2ZScpO1xuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU9uT3V0c2lkZUNsaWNrKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhpZGVNZW51KGUpIHtcbiAgICBzd2FwQ2xhc3MobWVudSwgJ3Nob3duJywgJ2hpZGRlbicpO1xuICAgIHJlbW92ZUNsYXNzKGxpbmssICdhY3RpdmUnKTtcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VPbk91dHNpZGVDbGljaywgZmFsc2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gY2xvc2VPbk91dHNpZGVDbGljayAoZSkge1xuICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICBpZiAoIWxpbmsuY29udGFpbnModGFyZ2V0KSAmJiAhbWVudS5jb250YWlucyh0YXJnZXQpKSB7XG4gICAgICBoaWRlTWVudSgpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBpbml0aWFsaXplUmlnaHRNZW51KCkge1xuICB2YXIgbmF2aWdhdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXZpZ2F0aW9uLXJpZ2h0Jyk7XG4gIHZhciBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bkb3duLXJpZ2h0Jyk7XG4gIHZhciBsaW5rcyA9IG5hdmlnYXRpb24uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYmxvY2stbGluaycpO1xuICB2YXIgc2VjdGlvbnMgPSBtZW51LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21lbnUnKTtcblxuICAvLyBGb3IgdGhyb3VnaCByaWdodCBuYXZpZ2F0aW9uIGxpbmtzIGFuZCBhdHRhY2ggbGlzdGVuZXJzIHRvIHRoZW1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykge1xuICAgIGxpbmtzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gY2hhbmdlUmlnaHRNZW51KGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHZhciBsaW5rID0gZS5jdXJyZW50VGFyZ2V0O1xuXG4gICAgICBpZiAoaGFzQ2xhc3MobGluaywgJ2FjdGl2ZScpKSB7XG4gICAgICAgIC8vIENsaWNraW5nIG9uIGEgc2VsZWN0ZWQgaWNvbiByZW1vdmVzIHRoZSBtZW51XG4gICAgICAgIGhpZGVNZW51KCk7XG4gICAgICAgIHJlbW92ZUNsYXNzKGxpbmssICdhY3RpdmUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNob3dNZW51KGxpbmsuZ2V0QXR0cmlidXRlKCdkYXRhLXNlY3Rpb24nKSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBoaWRlTWVudSgpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgICByZW1vdmVDbGFzcyhsaW5rc1tpXSwgJ2FjdGl2ZScpO1xuICAgIH1cbiAgICBzd2FwQ2xhc3MobWVudSwgJ3Nob3duJywgJ2hpZGRlbicpO1xuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU9uT3V0c2lkZUNsaWNrLCBmYWxzZSk7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93TWVudShzZWN0aW9uKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGxpbmtzW2ldLmdldEF0dHJpYnV0ZSgnZGF0YS1zZWN0aW9uJykgPT0gc2VjdGlvbikge1xuICAgICAgICBhZGRDbGFzcyhsaW5rc1tpXSwgJ2FjdGl2ZScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVtb3ZlQ2xhc3MobGlua3NbaV0sICdhY3RpdmUnKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHNlY3Rpb25zW2ldLmlkID09IHNlY3Rpb24pIHtcbiAgICAgICAgc2VjdGlvbnNbaV0uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWN0aW9uc1tpXS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgfVxuICAgIH1cbiAgICBzd2FwQ2xhc3MobWVudSwgJ2hpZGRlbicsICdzaG93bicpO1xuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU9uT3V0c2lkZUNsaWNrKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNsb3NlT25PdXRzaWRlQ2xpY2sgKGUpIHtcbiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgaWYgKCFuYXZpZ2F0aW9uLmNvbnRhaW5zKHRhcmdldCkgJiYgIW1lbnUuY29udGFpbnModGFyZ2V0KSkge1xuICAgICAgaGlkZU1lbnUoKTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qXG4gKiBBIHNpbXBseSBsaWJyYXJ5IGZvciBhIEphdmFTY3JpcHQgbW9kYWwgd2l0aCBubyBkZXBlbmRlbmNpZXMuICBcbiAqL1xuKGZ1bmN0aW9uIChnKSB7XG4gIGcuTW9kYWwgPSBmdW5jdGlvbiAobW9kYWxTZXR0aW5ncykge1xuICAgIC8vIEEgcmVmZXJlbmNlIHRvIHRoZSBtb2RhbCBwaWVjZXMgaW4gdGhlIGRvbVxuICAgIHRoaXMubW9kYWwgPSBudWxsO1xuICAgIHRoaXMub3ZlcmxheSA9IG51bGw7XG4gICAgdGhpcy5jbG9zZUJ1dHRvbiA9IG51bGw7XG5cbiAgICAvLyBJbml0aWFsaXplZCB0byBhbGwgb2YgdGhlIGRlZmF1bHRzIGZvciB0aGlzIHRoaW5nIVxuICAgIHRoaXMuc2V0dGluZ3MgPSB7XG4gICAgICBjbGFzc05hbWU6IFwiem9vbVwiLFxuICAgICAgaGFzQ2xvc2VCdXR0b246IHRydWUsXG4gICAgICBjb250ZW50OiBcIlwiLFxuICAgICAgdGl0bGU6IG51bGwsXG4gICAgICBtYXhXaWR0aDogODAwLFxuICAgICAgbWluV2lkdGg6IDIwMCxcbiAgICAgIGhhc092ZXJsYXk6IHRydWUsXG4gICAgICBpc0ZpeGVkOiB0cnVlLFxuICAgICAgbGlua1NlbGVjdG9yOiBudWxsXG4gICAgfTtcblxuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIGlmIChtb2RhbFNldHRpbmdzICYmIHR5cGVvZiBtb2RhbFNldHRpbmdzID09PSBcIm9iamVjdFwiKSB7XG4gICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5zZXR0aW5ncykge1xuICAgICAgICBpZiAobW9kYWxTZXR0aW5ncy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgdGhpcy5zZXR0aW5nc1trZXldID0gbW9kYWxTZXR0aW5nc1trZXldXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgY29udGVudCA9IHRoaXMuc2V0dGluZ3MuY29udGVudDtcbiAgICBpZiAoY29udGVudCAmJiBjb250ZW50LmlubmVySFRNTCkge1xuICAgICAgY29udGVudCA9IGNvbnRlbnQuaW5uZXJIVE1MO1xuICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLnNldHRpbmdzLmNvbnRlbnQpO1xuICAgICAgdGhpcy5zZXR0aW5ncy5jb250ZW50ID0gY29udGVudDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zZXR0aW5ncy5saW5rU2VsZWN0b3IgIT09IG51bGwpIHtcbiAgICAgIHZhciBsaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5zZXR0aW5ncy5saW5rU2VsZWN0b3IpO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxpbmtzW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBzZWxmLm9wZW4oKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIE1vZGFsLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKCkge1xuICAgIGJ1aWxkTW9kYWwuY2FsbCh0aGlzKTtcbiAgICBpbml0aWFsaXplRXZlbnRzLmNhbGwodGhpcyk7XG5cbiAgICAvLyBGb3IgYW5pbWF0aW9uc1xuICAgIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMubW9kYWwpLmhlaWdodDtcblxuICAgIHRoaXMubW9kYWwuY2xhc3NOYW1lICs9IHRoaXMubW9kYWwub2Zmc2V0SGVpZ2h0ID4gd2luZG93LmlubmVySGVpZ2h0ID9cbiAgICAgIFwiIG1vZGFsLWFjdGl2ZSBtb2RhbC1hbmNob3JlZFwiIDogXCIgbW9kYWwtYWN0aXZlXCI7XG4gICAgaWYgKHRoaXMub3ZlcmxheSkge1xuICAgICAgdGhpcy5vdmVybGF5LmNsYXNzTmFtZSArPSBcIiBtb2RhbC1hY3RpdmVcIjtcbiAgICB9XG4gIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHRoaXMubW9kYWwuY2xhc3NOYW1lID0gdGhpcy5tb2RhbC5jbGFzc05hbWUucmVwbGFjZShcIiBtb2RhbC1hY3RpdmVcIiwgXCJcIik7XG5cbiAgICB0aGlzLm1vZGFsLmFkZEV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkVuZCgpLCBmdW5jdGlvbiAoKSB7XG4gICAgICByZW1vdmVFbGVtZW50KHNlbGYubW9kYWwpO1xuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMub3ZlcmxheSkge1xuICAgICAgdGhpcy5vdmVybGF5LmNsYXNzTmFtZSA9IHRoaXMub3ZlcmxheS5jbGFzc05hbWUucmVwbGFjZShcIiBtb2RhbC1hY3RpdmVcIiwgXCJcIik7XG5cbiAgICAgIHRoaXMub3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKHRyYW5zaXRpb25FbmQoKSwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZW1vdmVFbGVtZW50KHNlbGYub3ZlcmxheSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBidWlsZE1vZGFsICgpIHtcbiAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgdGhpcy5tb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgdGhpcy5tb2RhbC5jbGFzc05hbWUgPSBcIm1vZGFsIFwiICsgdGhpcy5zZXR0aW5ncy5jbGFzc05hbWU7XG4gICAgdGhpcy5tb2RhbC5zdHlsZS5taW5XaWR0aCA9IHRoaXMuc2V0dGluZ3MubWluV2lkdGggKyBcInB4XCI7XG4gICAgdGhpcy5tb2RhbC5zdHlsZS5tYXhXaWR0aCA9IHRoaXMuc2V0dGluZ3MubWF4V2lkdGggKyBcInB4XCI7XG5cbiAgICBpZiAodGhpcy5zZXR0aW5ncy5oYXNDbG9zZUJ1dHRvbiA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5jbG9zZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICB0aGlzLmNsb3NlQnV0dG9uLmNsYXNzTmFtZSA9IFwibW9kYWwtY2xvc2UgbW9kYWwtY2xvc2UtYnV0dG9uXCI7XG4gICAgICB0aGlzLmNsb3NlQnV0dG9uLmlubmVySFRNTCA9IFwiw5dcIjtcbiAgICAgIHRoaXMubW9kYWwuYXBwZW5kQ2hpbGQodGhpcy5jbG9zZUJ1dHRvbik7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuaGFzT3ZlcmxheSA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5vdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHRoaXMub3ZlcmxheS5jbGFzc05hbWUgPSBcIm1vZGFsLW92ZXJsYXkgXCIgKyB0aGlzLnNldHRpbmdzLmNsYXNzTmFtZTtcbiAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHRoaXMub3ZlcmxheSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MudGl0bGUgIT09IG51bGwpIHtcbiAgICAgIHZhciB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMlwiKTtcbiAgICAgIHRpdGxlLmNsYXNzTmFtZSA9IFwibW9kYWwtdGl0bGVcIjtcbiAgICAgIHRpdGxlLmlubmVySFRNTCA9IHRoaXMuc2V0dGluZ3MudGl0bGU7XG4gICAgICB0aGlzLm1vZGFsLmFwcGVuZENoaWxkKHRpdGxlKTtcbiAgICB9XG5cbiAgICB2YXIgY29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY29udGVudC5jbGFzc05hbWUgPSBcIm1vZGFsLWNvbnRlbnRcIjtcbiAgICBjb250ZW50LmlubmVySFRNTCA9IHRoaXMuc2V0dGluZ3MuY29udGVudDtcbiAgICB0aGlzLm1vZGFsLmFwcGVuZENoaWxkKGNvbnRlbnQpO1xuXG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodGhpcy5tb2RhbCk7XG5cbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGluaXRpYWxpemVFdmVudHMoKSB7XG4gICAgaWYgKHRoaXMuY2xvc2VCdXR0b24pIHtcbiAgICAgIHRoaXMuY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm92ZXJsYXkpIHtcbiAgICAgIHRoaXMub3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2UuYmluZCh0aGlzKSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgpIHtcbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGlmIChlbC5zdHlsZS5XZWJraXRUcmFuc2l0aW9uKSByZXR1cm4gXCJ3ZWJraXRUcmFuc2l0aW9uRW5kXCI7XG4gICAgaWYgKGVsLnN0eWxlLk9UcmFuc2l0aW9uKSByZXR1cm4gXCJvVHJhbnNpdGlvbkVuZFwiO1xuICAgIHJldHVybiAndHJhbnNpdGlvbmVuZCc7XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVFbGVtZW50IChvYmopIHtcbiAgICBpZiAob2JqLnBhcmVudEVsZW1lbnQpIHtcbiAgICAgIG9iai5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKG9iaik7XG4gICAgfVxuICB9XG59KHdpbmRvdykpO1xuIiwiLy8gRnJvbSBodHRwOi8vamFrZXRyZW50LmNvbS9wb3N0L2FkZHJlbW92ZS1jbGFzc2VzLXJhdy1qYXZhc2NyaXB0L1xuZnVuY3Rpb24gaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkge1xuICBpZiAoZWwuY2xhc3NMaXN0KVxuICAgIHJldHVybiBlbC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKVxuICBlbHNlXG4gICAgcmV0dXJuICEhZWwuY2xhc3NOYW1lLm1hdGNoKG5ldyBSZWdFeHAoJyhcXFxcc3xeKScgKyBjbGFzc05hbWUgKyAnKFxcXFxzfCQpJykpXG59XG5cbmZ1bmN0aW9uIGFkZENsYXNzKGVsLCBjbGFzc05hbWUpIHtcbiAgaWYgKGVsLmNsYXNzTGlzdClcbiAgICBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSlcbiAgZWxzZSBpZiAoIWhhc0NsYXNzKGVsLCBjbGFzc05hbWUpKSBlbC5jbGFzc05hbWUgKz0gXCIgXCIgKyBjbGFzc05hbWVcbn1cblxuZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWwsIGNsYXNzTmFtZSkge1xuICBpZiAoZWwuY2xhc3NMaXN0KVxuICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKVxuICBlbHNlIGlmIChoYXNDbGFzcyhlbCwgY2xhc3NOYW1lKSkge1xuICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKCcoXFxcXHN8XiknICsgY2xhc3NOYW1lICsgJyhcXFxcc3wkKScpXG4gICAgZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lLnJlcGxhY2UocmVnLCAnICcpXG4gIH1cbn1cblxuZnVuY3Rpb24gc3dhcENsYXNzKGVsLCBjbGFzc0EsIGNsYXNzQikge1xuICByZW1vdmVDbGFzcyhlbCwgY2xhc3NBKTtcbiAgYWRkQ2xhc3MoZWwsIGNsYXNzQik7XG59XG5cbi8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTAyNjA2OS9jYXBpdGFsaXplLXRoZS1maXJzdC1sZXR0ZXItb2Ytc3RyaW5nLWluLWphdmFzY3JpcHRcbmZ1bmN0aW9uIGNhcGl0YWxpemVGaXJzdChzdHJpbmcpIHtcbiAgICByZXR1cm4gc3RyaW5nLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyaW5nLnNsaWNlKDEpO1xufVxuXG4vLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzg4MzA4MzkvamF2YXNjcmlwdC1kb20tcmVtb3ZlLWVsZW1lbnRcbmZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQoZWwpIHtcbiAgaWYgKGVsKSB7XG4gICAgZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbCk7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
